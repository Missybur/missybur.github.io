(function(i,j,s){i.execute(function(){i.when("A","dv-web-player-config","dv-dp-mta-dropdown","logging").register("dv-dp-autoplay",function(d,h,e,g){var c=d.$,f=g.create("dv-dp-autoplay"),b,g=function(a){f.log("[PLAYER-AUTOPLAY] init");var d=c("#dv-buybox-play .dv-play-btn:first a, #dv-buybox-play .dv-play-btn:first input");d.length&&(a={asin:d.data("asin"),isAVOD:d.data("is-avod"),fromSecond:d.data("resume-time")});a=h.getAutoplayConfig(a);f.log("[PLAYER-AUTOPLAY] formatAutoplayConfig",a);e&&typeof e.getSelectedAudioTrackId!==
"undefined"&&c.extend(a,e.getSelectedAudioTrackId());b=a},a=function(){f.log("[PLAYER-AUTOPLAY] isAutoPlayOn",b);return b.asin&&(b.autoPlayOn||b.trailer)};g();return{init:g,isAutoPlayOn:a,triggerAutoPlay:function(){f.log("[PLAYER-AUTOPLAY] triggerAutoPlay",b);if(!a())return f.log("[PLAYER-AUTOPLAY] triggerAutoPlay returns",!1),!1;d.trigger("dv:dp:player:continue",{asin:b.asin,trailer:b.trailer||!1,position:parseInt(b.fromSecond,10),isAVOD:b.isAVOD||!1,clickstreamRefMarker:b.clickstreamRefMarker,clickstreamSessionId:b.clickstreamSessionId,
audioTrackId:b.audioTrackId,playerSize:b.playerSize});f.log("[PLAYER-AUTOPLAY] triggerAutoPlay returns",!0);return!0}}});i.when("A").register("dv-dp-mta-dropdown",function(d){var h=d.$,e={init:function(){this.selectedAudioTrackId=h("[name='audioTrackId']").val();this.bindEvents()},bindEvents:function(){var g=this;d.on("a:dropdown:selected:audioTrackId",function(c){g.setAudioTrackId(c)});d.on("dv:ajax:chunk:replaced:dv-action-box",function(){g.init()})},setAudioTrackId:function(d){this.selectedAudioTrackId=
d.value;h("#mta-dropdown .selected-language").html(d.auiItemNode.text.trim())},getSelectedAudioTrackId:function(){return this.selectedAudioTrackId}};e.init();return e});i.when("A","logging","dv-dp-autoplay","dv-dp-playback-init").register("dv-playback-buttons",function(d,h,e){var g=d.$,c=h.create("dv-playback-buttons"),f={position:0,runtime:0,endOffsetPercent:5,trailerIsOn:!1};({init:function(){this.addPlayerEventListeners();this.initDefaults();e.isAutoPlayOn()||this.preparePlayback()},initDefaults:function(){var b,
a;c.log("[PLAYBACK-BUTTONS] initDefaults");this.templates={};this.templates.$watchNow=g("#watch-now-button-template");this.templates.$watchFromBeginning=g("#from-beginning-button-template");this.templates.$resume=g("#resume-button-template");this.elements={};this.elements.$watchFromBeginning=g("#from-beginning-btn");this.elements.$watchNowButton=g("#continue-btn");this.elements.$playbackButtonContainer=g("#dv-playback-button-container");this.elements.$trailerButton=g("#dv-dp-left-content .dv-trailer");
b=this.elements.$watchNowButton.data("playback");a=this.elements.$watchFromBeginning.data("playback");this.options=g.extend({},f,b,a);c.log("[PLAYBACK-BUTTONS] initDefaults OPTIONS",{elements:this.elements,defaults:f,continueOptions:b,fromBeginningOptions:a,options:this.options})},savePlaybackRequestData:function(b){c.log("[PLAYBACK-BUTTONS] savePlaybackRequestData",b);this.options.trailerIsOn=b.trailer;this.options.runtime=b.runtime},preparePlayback:function(){var b=[this.elements.$watchNowButton,
this.elements.$watchFromBeginning,this.elements.$trailerButton],a;for(c.log("[PLAYBACK-BUTTONS] preparePlayback");b.length;)if(a=b.shift(),a.length&&(a=a.data("playback"),a!==s&&a.asin)){d.trigger("dv:dp:player:prepare",a);break}},addPlayerEventListeners:function(){var b=this;c.log("[PLAYBACK-BUTTONS] addPlayerEventListeners");d.on("dv:dp:player:continue",function(a){b.savePlaybackRequestData(a)});d.on("dv:dp:player:startFromBeginning",function(a){b.savePlaybackRequestData(a)});d.on("dv:dp:player:playTrailer",
function(a){b.savePlaybackRequestData(a)});d.on("dv:player:closed",function(a){c.log("[PLAYBACK-BUTTONS] triggered dv:player:closed",a);a&&a.position&&(b.updateresumeTimeInSeconds(a.position),b.updatePlaybackButtons())});d.on("dv:dp:sidebox:reloaded",function(){c.log("[PLAYBACK-BUTTONS] watchButtonReloaded preparePlayback");b.initDefaults();b.preparePlayback()})},updateresumeTimeInSeconds:function(b){if(!this.options.trailerIsOn)this.options.position=b},getPlaybackPercent:function(){return!this.options.runtime?
0:parseInt(this.options.position/this.options.runtime*100,10)},updatePlaybackButtons:function(){c.log("[PLAYBACK-BUTTONS] updatePlaybackButtons trailerIsOn:"+this.options.trailerIsOn);this.options.trailerIsOn||(this.shouldUseMultipleButtons()?g("#continue-btn").length?this.updatePositionOnPlaybackButton(g("#continue-btn"),this.options.position):this.showMultplePlaybackButtons(this.options.position):this.showSinglePlaybackButton())},updatePositionOnPlaybackButton:function(b,a){var l=this.getPlaybackPercent(),
f=b.data("playback");c.log("[PLAYBACK-BUTTONS] updatePositionOnPlaybackButton",a);b.find(".dv-progress-bar").width(l+"%");if(b.length&&f)f.position=a,b.data("playback",f),c.log("[PLAYBACK-BUTTONS] updatePositionOnPlaybackButton config:",f);return b},showMultplePlaybackButtons:function(b){var a=this.templates.$resume.html(),b=this.updatePositionOnPlaybackButton(g(a),b),a=this.templates.$watchFromBeginning.html();this.elements.$playbackButtonContainer.empty().prepend(g(a)).prepend(b)},showSinglePlaybackButton:function(){var b=
this.templates.$watchNow.html(),b=this.updatePositionOnPlaybackButton(g(b),0);this.elements.$playbackButtonContainer.empty().prepend(b)},shouldUseMultipleButtons:function(){var b=this.options.runtime-this.options.position,a=this.options.runtime*this.options.endOffsetPercent/100;c.log("[PLAYBACK-BUTTONS] shouldUseMultipleButtons",{runtime:this.options.runtime,remainingSeconds:b,endOffsetSeconds:a});return b>a&&this.options.position>60}}).init()});i.when("dv-dp-playback","dv-dp-playback-view").register("dv-dp-playback-init",
function(d,h){h.init();d.init(h)});i.when("A","logging").register("dv-dp-playback-view",function(d,h){var e=d.$,g=h.create("dv-dp-playback-view"),c={selectors:{body:"#dv-product-details",contentContainer:".dv-dp-content",titleContent:".dv-dp-title-content",playerContent:".dv-player-content",leftContent:".dv-dp-left-content",rightContent:".dv-action-box",backgroundHeroshot:".aivDetailsBackgroundPanel",episodeContainer:".dv-episode-container",radialButton:".dv-play-button-radial",document:"html, body"}},
f={name:"small",heroshotOpacity:0.2},b={name:"medium",heroshotOpacity:0},a={name:"large",heroshotOpacity:0};return function(){var l={},h,m,k,q,t,p,o,A,u=null,v=null,z=function(a){var b=o.outerHeight(!0);return Math.max(b,a)+q.outerHeight(!0)},B=function(){var a=document.createElement("div");a.className="scrollbar-measure";document.body.appendChild(a);var b=a.offsetWidth-a.clientWidth;document.body.removeChild(a);return b},w=function(){var a=q.innerWidth()-o.outerWidth();return{width:q.outerWidth()-
o.outerWidth(),height:Math.min(Math.floor(a/16*9)-20,600)}},D=function(a,b,c){i.when("dv-ajax-reload").execute(function(l){l.getWidgets({asin:a,loggingName:"dvweb-update-playback",widgets:b,DOMRootID:c})})};return{init:function(){e.extend(l,c);d.on("dv:dp:heroshot:ready",function(){g.log("[PLAYBACK-VIEW] triggered dv:dp:heroshot:ready");h=e(l.selectors.backgroundHeroshot);v!==null&&(h.css({opacity:v.heroshotOpacity}),g.log("[PLAYBACK-VIEW] _setHeroshotOpacity",v))});m=e(l.selectors.body);k=e(l.selectors.contentContainer);
u=k.outerHeight({margin:!0});q=e(l.selectors.titleContent);t=e(l.selectors.playerContent);p=e(l.selectors.leftContent);o=e(l.selectors.rightContent);h=e(l.selectors.backgroundHeroshot);A=e(l.selectors.document);g.log("[PLAYBACK-VIEW] playerView init runs")},updateActionPlayback:function(){if(v!==null){var a=e("#dv-buybox-play .dv-play-btn:first a").data("page-asin");a&&D(a,["dv-action-box"])}},updateEpisodePlayback:function(a){if(v!==null){var b=e(l.selectors.radialButton).find('[data-asin="'+a+'"]').parents(l.selectors.episodeContainer).attr("id");
b&&D(a,["js-ajaxable-episode-status"],b)}},openSmallPlayer:function(){var a;i.when("navbarJSLoaded").execute(function(){navbar.lockFlyouts(!0)});u=k.outerHeight({margin:!0});p.animate({opacity:"0"},400,function(){a=w();k.animate({height:z(a.height)},500,function(){t.css({left:"0",top:q.outerHeight(!0),width:a.width,height:a.height,paddingRight:"20px",paddingBottom:"20px"}).animate({opacity:"1"},400,function(){d.trigger("dv:dp:player:view:smallplayer:transitioned")})})});h.fadeTo(400,f.heroshotOpacity);
o.fadeTo(400,1);q.fadeTo(400,1);v=f;g.log("[PLAYBACK-VIEW] playerView small player opened.")},openMediumPlayer:function(){i.when("navbarJSLoaded").execute(function(){navbar.lockFlyouts(!0)});p.fadeTo(400,0);o.fadeTo(400,0);u=k.outerHeight({margin:!0});k.animate({height:"580px"});t.css({width:j.innerWidth||(document.documentElement.clientWidth||document.body.clientWidth)+B(),height:"580px",paddingRight:B(),paddingBottom:"0px",top:"0px",left:"0px"});q.animate({opacity:"0"},400,function(){k.css({width:"100%",
margin:"0px"});t.animate({opacity:"1"},400,"linear")});h.animate({opacity:b.heroshotOpacity});v=b;g.log("[PLAYBACK-VIEW] playerView medium player opened.")},openLargePlayer:function(){i.when("navbarJSLoaded").execute(function(){navbar.lockFlyouts(!0)});A.css("overflow","hidden");t.css({position:"fixed",top:"0px",left:"0px",width:"100%",height:"100%",paddingRight:"0px",paddingBottom:"0px"}).animate({opacity:"1"},100,"linear");v=a;g.log("[PLAYBACK-VIEW] playerView large player opened.")},resizePlayerToContainer:function(){var a;
v===b?t.css({width:k.innerWidth()+B(),height:k.innerHeight()}):v===f&&(a=w(),t.css({width:a.width,height:a.height}),k.css({height:z(a.height)}))},closePlayer:function(){if(v!==null){var b=v;g.log("[PLAYBACK-VIEW] playerView closing player.",v);m.removeClass("auto-play-on");i.when("navbarJSLoaded").execute(function(){navbar.unlockFlyouts()});A.css("overflow","");t.animate({opacity:"0"},400);setTimeout(function(){g.log("[PLAYBACK-VIEW] firstTimeoutBlock");t.css({position:"absolute",width:"300px",height:"300x",
paddingBottom:"0px",left:"-300px"});g.log("[PLAYBACK-VIEW] playercss");k.css({width:"",margin:""});g.log("[PLAYBACK-VIEW] contentContainer css")},400);setTimeout(function(){g.log("[PLAYBACK-VIEW] secondTimeoutBlock");var c=function(){k.css({height:"",overflow:""})};b===a?c():k.animate({height:u},800,c);g.log("[PLAYBACK-VIEW] contentContainer height css");h.animate({opacity:"1"},200);g.log("[PLAYBACK-VIEW] backgroundHeroshot css");o.fadeIn(900,function(){g.log("[PLAYBACK-VIEW] rightContent fadingTo");
o.css({opacity:"1"})});q.fadeIn(900,function(){q.css({opacity:"1"})});p.fadeIn(900,function(){p.css({opacity:"1"})})},800);v=null;g.log("[PLAYBACK-VIEW] playerView closed player.",v)}}}}()});i.when("A","dv-player-integration-layer","dv-dp-autoplay","dv-dp-mta-dropdown","logging","dv-web-player-config","dv-analytics").register("dv-dp-playback",function(d,h,e,g,c){return function(){var f,b=c.create("dv-dp-playback"),a={listenForTrailer:!0,listenForPlayback:!0},l=function(){b.log("[PLAYBACK] enableListeners");
a.listenForTrailer=!0;a.listenForPlayback=!0},n=function(c){b.log("[PLAYBACK] onPlaybackRequest",a,c);if(c.trailer&&a.listenForTrailer||!c.trailer&&a.listenForPlayback){a.listenForTrailer=!1;a.listenForPlayback=!1;c=c||{};c.audioTrackId=k();b.log("[PLAYBACK] Playback startPlayback runs",c);if(c.trailer){if(b.log("[PLAYBACK] Playback startPlayback for trailer"),!c.playerSize)c.playerSize="small"}else if(b.log("[PLAYBACK] Playback startPlayback for title"),!c.playerSize)c.playerSize="large";switch(c.playerSize.toLowerCase()){case "small":f.openSmallPlayer();
break;case "medium":f.openMediumPlayer();break;case "large":f.openLargePlayer();break;default:b.warn('[PLAYBACK] Unknown player size "'+c.playerSize+'", defaulting to large player'),f.openLargePlayer()}h.play(c)}},m=function(){b.log("[PLAYBACK] setEventListeners");l();d.on.resize(function(){f.resizePlayerToContainer()});d.on("dv:dp:player:prepare",function(c){b.log("[PLAYBACK] triggered dv:dp:player:prepare",a);q(c)});d.on("dv:dp:player:playTrailer",n);d.on("dv:dp:player:continue",n);d.on("dv:dp:player:startFromBeginning",
n);d.on("dv:dp:player:close",function(){b.log("[PLAYBACK] triggered dv:dp:player:close",a);b.log("[PLAYBACK] Playback endPlayback runs");f.closePlayer();h.stop();l()});d.on("dv:player:closed",function(c){b.log("[PLAYBACK] triggered dv:player:closed",a);c&&c.asin&&f.updateEpisodePlayback(c.asin);f.updateActionPlayback();f.closePlayer();l()});d.on("dv:dp:player:view:smallplayer:transitioned",function(){b.log("[PLAYBACK] triggered dv:dp:player:view:smallplayer:transitioned",a);a.listenForPlayback=!0});
d.on("dv:player:asin:changed",function(a){f.updateEpisodePlayback(a.prevAsin)})},k=function(){if(g&&typeof g.getSelectedAudioTrackId!=="undefined")return g.getSelectedAudioTrackId()},q=function(a){i.when("dv-player-capabilities").execute(function(c){c.get(function(c){if(c&&c.supportsWebPlayback)a=a||{},a.audioTrackId=k(),b.log("[PLAYBACK] Playback preparePlayback runs",a),h.prepare(a)})})};return{init:function(a){b.log("[PLAYBACK] Playback init runs");f=a;h.init(d);m();e.triggerAutoPlay()}}}()});
i.when("A","logging").register("dv-player-capabilities",function(d,h){var e=s,g=h.create("dv-player-capabilities"),c=function(){return{init:function(){g.log("[PLAYER-CAPABILITIES] init");d.on("dv:player:apply:capabilities",function(c){e=c})},get:function(c){g.log("[PLAYER-CAPABILITIES] get",c);c&&typeof c==="function"&&(e?c(e):(g.log("[PLAYER-CAPABILITIES] subscribe",c),d.on("dv:player:apply:capabilities",c)));return e},unsubscribe:function(c){g.log("[PLAYER-CAPABILITIES] unsubscribe",c);d.off("dv:player:apply:capabilities",
c)}}}();c.init();return c});i.when("A","dv-web-player-config","logging").register("dv-player-integration-layer",function(d,h,e){var g=s,c=e.create("dv-player-integration-layer"),f,b,a,l;return function(){function d(a){i.now(e).execute(function(b){b?a(b):i.when(e).execute(a)})}var e="dv-player-initialized",k=function(b){c.log("[PLAYER-INTEGRATION] onClosed",b);b=b||{};b.asin=f;a.trigger("dv:player:closed",b)},q=function(b){c.log("[PLAYER-INTEGRATION] onAsinChanged",b);a.trigger("dv:player:asin:changed",
{prevAsin:f,nextAsin:b.asin});f=b.asin},t=function(b){c.log("[PLAYER-INTEGRATION] onPlayerCapabilities",b);a.trigger("dv:player:apply:capabilities",b.capabilities)},p=function(a){var l={domElement:typeof a.domElement==="string"?document.getElementById(a.domElement):a.domElement,marketplaceId:a.marketplaceId,customerId:a.customerId,playerPreference:a.playerPreference,locale:a.locale};if(a&&a.hasOwnProperty("requiredCapabilities"))a=a.requiredCapabilities,l.requiredCapabilities={supportsLive:!!a.supportsLive,
supportsDrm:!!a.supportsDrm};c.log("[PLAYER-INTEGRATION] initialize",l);g=l;b.initialize(l)},o=function(a){c.log("[PLAYER-INTEGRATION] formatContentConfig",a);var b={asin:a.asin,position:a.position||0,trailer:a.trailer?!0:!1,isAVOD:a.isAVOD||!1};if(a.lcid)b.live=!!a.lcid,b.asin=a.lcid;return b};return{init:function(l){c.log("[PLAYER-INTEGRATION] init");a=l;l=function(){c.log("[PLAYER-INTEGRATION] initAndBind");b=new j.WebPlayer;b.on("closed",k);b.on("asinChanged",q);b.on("playerCapabilities",t);p(h.getPlayerConfig());
i.now(e).execute(function(a){a||i.declare(e,b)})};j.WebPlayer?l():i.when("web-player-script-loaded").execute(l)},prepare:function(a){d(function(){var l=g,d=o(a);c.log("[PLAYER-INTEGRATION] prepare",l,d);b.prepare(l,d)})},play:function(a){d(function(){var l=g,d=o(a),e={audioTrackId:a.audioTrackId,clickstreamRefMarker:a.clickstreamRefMarker,clickstreamSessionId:a.clickstreamSessionId};c.log("[PLAYER-INTEGRATION] play",l,d,e);f=a.asin;b.play(l,d,e)})},stop:function(){d(function(){p(h.getPlayerConfig());
a.trigger("dv:player:closed")})},_getPlayerInstance:function(){return b},whenInitialized:d,logClientSideMetrics:function(a){c.info("CSM! player-integration",a);d(function(b){c.info("CSM! whenInitialized",a,b);j.uet("cf",a,{wb:1});b.on("pinRequired",function(){c.info("CSM! pinRequired",a);l=!0});b.on("playing",function(){c.info("CSM! playing",a);l||(l=!0,c.info("CSM! first-frame",a),j.uex("ld",a,{wb:1}))})})}}}()});i.when("A","dv-ready-atf").register("dv-web-player-config",function(d){var h=d.$;return function(){var d=
function(d,c,f){d=d.data(c);return h.extend({},d,f)};return{getPlayerConfig:function(g){return d(h("#dv-web-player"),"config",g)},getAutoplayConfig:function(g){return d(h("#dv-player-content"),"auto-play",g)}}}()})})})(function(){var i=window.AmazonUIPageJS||window.P,j=i._namespace||i.attributeErrors;return j?j("DigitalVideoWebPlaybackAssets"):i}(),window);
(function(i,j,s){i.execute(function(){i.when("jQuery","ready").execute(function(d){function h(n){var i=n.offset(),q,t=d(j),o=t.height(),D=t.width(),A=t.scrollTop(),F=t.scrollLeft(),o=A+o,D=F+D,H=d("#player_object").length||d("#dv-dp-player-content").css("opacity")>0;d(".dv-fs").length&&(A+=d(".dv-fs").outerHeight()+40);i.bottom=i.top+n.outerHeight();i.right=i.left+n.outerWidth();var r=o<i.bottom&&!H?1:0,C=A>i.top?1:0,x=F>i.left?1:0,J=D<i.right?1:0;clearTimeout(b);clearTimeout(a);l&&l.abort();var A=
d("#content"),y="storefront";A.length===0&&(n.parents("#dv-bundle").length===1?(A=d("#dv-bundle"),y="detailBundle"):n.parents("#dv-sims").length===1&&(A=d("#dv-sims"),y="detailSim"));A.length===0&&(A=d("#aiv-cl"),y="watchlist");var G="dv-universal-hover";G+=n.data("type")==="downloadable_movie"?"-movie":"-tv";A.append(g(n));b=setTimeout(function(){d("#uh-ajax-data").html("");d("#uh-title").text("");d("#uh-releaseDate").text("");d("#uh-channelname").text("");d("#uh-cc").removeClass("dv-badge");d("#uh-live").removeClass("dv-badge");
d("#uh-starRating").html("");d("#uh-synopsis p").html("");d("#uh-grayBar").html("");d("#uh-greenBar").html("");d("#uh-orangeBar").html("");d("#uh-parentalControls").html("");d("#uh-purchaseOptions").html("");d("#uh-watchListButton").html("");d("#uh-watchBox").html("");d("#uh-nextUp").html("");a=setTimeout(function(){typeof m==="function"&&typeof k==="function"&&(k("t0",G,new Date),m("bb",G,{wb:1}),p&&j.console.log(G+": clickToBodyBegin"));d("#universal-hover").css({left:"-1000px"}).show();d("#universal-hover #header").height();
d("#universal-hover").hide();q=n.width()+11;var a=i.left+q,b=0,c=t.width(),f=1E3;y==="storefront"?(b=i.top-40,f=c-300):y==="watchlist"&&(b=i.top-40,f=800);var g=d("#arrow-hover");r||C?(r&&(g.addClass("watchlist-arrow-Bottom"),b-=d("#universal-hover").height()+12),C&&(g.addClass("watchlist-arrow-Top"),b+=250),a=i.left,i.left+q>f&&(g.addClass("rightAlign"),a-=n.data("type")==="downloadable_movie"?134:0),x&&(g.addClass("outOfBoundsLeft"),a=-10),J&&(g.addClass("outOfBoundsRight"),a=c-260)):i.left+q<f?
g.addClass("watchlist-arrow-Left"):(a-=n.data("type")==="downloadable_movie"?435:562,g.addClass("watchlist-arrow-Right"));d("#universal-hover").css({left:a,top:b}).data("ps",n).fadeIn();e(G,"render");l=null},n.attr("data-render-hover"));d("#universal-hover").removeClass().addClass(n.data("type"));d("#prime-messaging").removeClass("prime").addClass(n.data("prime"));l=d.ajax({dataType:"json",timeout:1E4,data:{json:1},url:"/gp/video/beard"+f(n),success:function(a){d("#uh-ajax-data").html(a);d("#uh-title").text(a.title);
d("#uh-title").attr("href","/gp/product/"+a.asin+"/ref=dv_web_wtls_ovl_tit");d("#uh-releaseDate").text(a.releaseDate);d("#uh-channelName").text(a.channelname);d("#uh-rating").text(a&&a.textRating?a.textRating:a.rating);d("#uh-rating").addClass("dv-"+a.rating);d("#uh-cc").addClass(a.cc===1?"dv-badge":"");d("#uh-cc").text(a.cc===1?"CC":"");d("#uh-live").addClass(a.live===1?"dv-badge":"");d("#uh-live").text(a.live===1?"Live":"");d("#uh-starRating").html(a.starRating);d("#uh-synopsis p").html(a.synopsis);
d("#uh-grayBar").html(a.grayBar);d("#uh-greenBar").html(a.greenBar);d("#uh-orangeBar").html(a.orangeBar);d("#uh-parentalControls").html(a.parentalControls);d("#uh-purchaseOptions").html(a.purchaseOptions);d("#uh-watchListButton").html(a.watchListButton);d("#uh-watchBox").html(a.watchBox);d("#uh-nextUp").html(a.nextUp);d(".spinner").remove();e(G,"ajax");if(a.live===1&&a.asin!==n.data("asin")){var b=n.find(".dv-packshot-image"),l=n.find(".a-link-normal");n.find(".dv-packshot-title").html("");c();b.fadeOut(1E3,
function(){b.attr("src",a.image);l.removeClass("dv-movie dv-season dv-episode");l.addClass("dv-"+a.contentType==="tv"?"episode":"movie");n.data("asin",a.asin);n.data("type","downloadable_"+a.contentType);b.fadeIn(1E3,function(){d(j).trigger("resize")})});h(n)}if(r){var f;f=y==="storefront"||y==="watchlist"?i.top-d("#universal-hover").outerHeight()-12:42-d("#universal-hover").outerHeight();d("#universal-hover").css({top:f})}},error:function(){c()}})},n.attr("data-ajax-request"))}function e(a,b){b===
"render"&&typeof m==="function"?m("af",a,{wb:1}):b==="ajax"&&typeof m==="function"&&m("cf",a,{wb:1});n.push(b);p&&j.console.log(a+" event: "+b);n.length===2&&(p&&j.console.log(a+" eventMonitor has received two events: "+n),n[0]==="render"&&(t.count(a+":spinner",1),p&&j.console.log(a+": box rendered before data available, updating spinner count")),typeof i==="function"&&(i("ld",a,{wb:1}),p&&j.console.log(a+": metrics submitted to server")))}function g(a){a.hasClass("video_rental");var b=a.data("lcid")!==
s?'<p id="uh-title"></p>':'<a href="#" id="uh-title"></a>',a=a.data("channelname")!==s?'<div id="uh-channelName" class="light-header">'+a.data("channelname")+"</div>":"";return'<div id="universal-hover" class=""><span id="arrow-hover" class=""></span><div id="header" class="a-spacing-small"><h1 class="inline-header a-size-medium">'+b+'</h1><h2 id="uh-releaseDate" class="light-header inline-header a-size-base a-spacing-small"></h2>'+a+'<p id="uh-starRating" class="a-size-mini a-spacing-mini rating"></p><p class="a-size-mini a-text-center aiv-messaging" id="prime-messaging"></p></div><span class="spinner"></span><div id="uh-grayBar" class="a-spacing-small"></div><div id="uh-greenBar" class="a-spacing-small"></div><div id="uh-orangeBar" class="a-spacing-small"></div><div id="uh-purchaseOptions" class="a-spacing-small"></div><div id="uh-synopsis"><p class="a-size-mini a-spacing-small"></p></div><span id="uh-live" class="a-spacing-mini"></span><span id="uh-cc" class="a-spacing-mini"></span><span id="uh-rating" class="dv-badge a-spacing-mini"></span><div id="uh-parentalControls" class="a-spacing-small"></div><div id="uh-watchBox" class="a-spacing-small"></div><div id="uh-watchListButton" class="a-spacing-small"></div><div id="uh-nextUp" class="a-spacing-small"></div></div>'}
function c(){d("#universal-hover").remove();d("#universal-hover").stop(!0,!0).hide()}function f(a){var b=a.parents(".shelf"),c="?",a={ASIN:a.attr("data-asin"),LCID:a.attr("data-lcid"),contextLinkText:b.attr("data-context-link-text"),contextLinkURL:b.attr("data-context-link-url"),shelfType:b.attr("data-shelf-type"),reftagPrefix:b.attr("data-reftag-prefix"),whyReasons:a.attr("data-why-reasons"),isByPostRental:a.hasClass("video_rental")};a.LCID=a.LCID==="undefined"||!a.LCID?"":a.LCID;a.contextLinkText=
a.contextLinkText==="undefined"||!a.contextLinkText?"":a.contextLinkText;a.contextLinkURL=a.contextLinkURL==="undefined"||!a.contextLinkURL?"":a.contextLinkURL;a.shelfType=a.shelfType==="undefined"||!a.shelfType?"":a.shelfType;a.whyReasons=a.whyReasons==="undefined"||!a.whyReasons?"":a.whyReasons;a.reftagPrefix=a.reftagPrefix==="undefined"||!a.reftagPrefix?"":a.reftagPrefix;a.isByPostRental=a.isByPostRental==="undefined"||!a.isByPostRental?"":1;c+=d.param(a);return c}var b,a,l,n=[],m=j.uet,k=j.ues,
i=j.uex,t=j.ue,p=0;if(d("#pageData").length>0)for(var o=d("#pageData").data("debug"),o=o.split(","),A=0;A<o.length;A++)p=o[A]==="verbose"?1:p;d.fn.live&&(d(".dv-universal-hover-enabled").live("mouseenter",function(){n=[];d("#universal-hover").length===0&&h(d(this))}),d(".dv-universal-hover-enabled").live("mouseleave click",function(b){clearTimeout(a);n=[];d(b.relatedTarget).is("#universal-hover, #arrow-hover")||c()}),d("#universal-hover").live("mouseleave",function(a){n=[];d(a.relatedTarget).parents().index(d(this).data("ps"))<
0&&c()}),d("a.remove-link, a.item-remove").live("click",function(a){a.preventDefault();var b=d(this).attr("data-asin"),c=d(this).attr("data-shelf-type");d.ajax({data:{asin:d(this).attr("data-asin"),token:d(this).attr("data-token"),type:d(this).attr("data-shelf-type")},dataType:"json",success:function(a){if(a.success){d(this).unbind("click");var l=d("<div/>"),a=d("<p>"+a.success+"</p>"),f='ul.shelf[data-shelf-type="'+c+'"] '+('li[data-asin="'+b+'"]');d(f).children(".confirmation-overlay").length>0||
(l.addClass("confirmation-overlay").html(a).width(d(f).outerWidth()).height(d(f).outerHeight()),d(f).append(l).removeClass("dv-universal-hover-enabled").unbind("mouseenter"),l.hide().fadeIn())}},timeout:1E4,url:"/gp/video/utilities/lists/ajax/hide.html"})}),d(".watch-tab-remove").live("click",function(){d("a.dv-cl-item-remove").length===0&&d("a.item-remove").length>0&&d("#universal-hover").find("a.item-remove").trigger("click")}),d(".watch-tab-add").live("click",function(){var a=d("#universal-hover").find("a.item-remove"),
b=a.attr("data-asin"),a=a.attr("data-shelf-type");d('ul.shelf[data-shelf-type="'+a+'"] li[data-asin="'+b+'"]').children(".confirmation-overlay").fadeOut().remove()}),d("a.why-recommend-link").live("click",function(a){a.preventDefault();var a=d(this).attr("href"),b=j.innerHeight,c=Math.round(j.innerWidth/2-275),b=Math.round(b*0.3);j.open(a,"whyRecommended","height=450,width=550,left="+c+",top="+b+",menubar=0,scrollbars=1,toolbar=0,status=0")}))})})})(function(){var i=window.AmazonUIPageJS||window.P,
j=i._namespace||i.attributeErrors;return j?j("DigitalVideoHoverAssets"):i}(),window);
(function(i,j,s){i.execute(function(){i.when("A","ready").register("dv-carousel",function(d){var e=d.$,d=e(".dv-wdgt-carousel").not(".carousel-loaded").filter(":visible"),g=e(j),c=!1,f="ontouchstart"in document.documentElement;if(j.navigator.msMaxTouchPoints||f)c=!0;var b=function(a){this.init(a)};b.prototype={init:function(a){this.cacheElements(a);this.initDefaults();this.measureAll();this.createUI();this.bindEvents()},cacheElements:function(a){this.$carousel=a;this.$shelf=this.$carousel.find(".shelf");
this.$items=this.$shelf.find("li")},initDefaults:function(){this.ATTR={CONTROL_DIR:"data-direction",IMG_SRC:"src",IMG_DATA_SRC:"data-src-lazy",REF_TAG:"data-reftag"};this.CLASS={CONTROL:"carousel-control",CONTROL_INACTIVE:"carousel-control-inactive",PROGRESS_BAR:"carousel-progress-bar",PROGRESS_BAR_CONTAINER:"carousel-progress-bar-container",PROGRESS_BAR_SCRUBBER:"carousel-progress-bar-scrubber",PROGRESS_BAR_TRACK:"carousel-progress-bar-track",TOUCH:"carousel-touch"};this.CSS={PROGRESS_BAR_SLEEP:{height:4,
top:16},PROGRESS_BAR_WAKE:{height:8,top:14},PROGRESS_BAR_SEMI_HIDE_INACTIVE:{PROGRESS_BAR_HIDE:{height:0,opacity:0},PROGRESS_BAR_SHOW:{height:25,opacity:1}},PROGRESS_BAR_HIDE_INACTIVE:{PROGRESS_BAR_HIDE:{opacity:0},PROGRESS_BAR_SHOW:{opacity:1}}};this.DIR={LEFT:"left",RIGHT:"right"};this.DISTANCE={BOUNCE_IN:0,BOUNCE_SHELF_OUT:30,BOUNCE_BAR_OUT:0.05};this.EASE={BOUNCE_BAR_IN:"easeOutCubic",BOUNCE_PAGE_IN:"easeOutBack",BOUNCE_OUT:"swing",CONTROLS_TOGGLE:"easeOutQuad",LAZY_LOAD_IN:"easeOutQuad",PAGE_TURN_DYNAMIC:"easeInOutQuad",
PROGRESS_BAR_WAKE:"easeOutCubic"};this.EVENTS={CAROUSEL_DISPLAY:"display.carousel",CSS_TRANSITION_END:"transitionend webkitTransitionEnd oTransitionEnd",CHANGE_PAGE:"changePage.carousel",START_DRAG:"startDrag.carousel",END_DRAG:"endDrag.carousel"};this.INTERVAL={PAGE_SCROLL:1E3};this.OPACITY={CONTROL_ACTIVE:1,CONTROL_CAROUSEL_INACTIVE:0.3,CONTROL_INACTIVE:0.5};this.SPEED={BOUNCE_OUT:100,BOUNCE_IN:400,CONTROLS_TOGGLE:150,LAZY_LOAD_IN:300,MOUSELEAVE_INTENT:250,PAGE_TURN_DYNAMIC_MAX:500,PAGE_TURN_DYNAMIC_MIN:200};
this.TYPE={DYNAMIC:"dynamic"};this.METRICS={TOUCH_START_END_THRESHOLD:25,TOUCH_SCROLL_UPDATE_DELAY:50};this.TOUCH={scrolled:!1};this.IS_TOUCH_ENABLED=this.$carousel.hasClass(this.CLASS.TOUCH);this.state={active:!1,bounceLock:!1,hasInteracted:!1,isDragging:!1,mouseOn:!1,type:""};this.measurement={carousel:{topOffset:this.$carousel.offset().top,width:0},itemSpacing:0,itemWidths:[],mouseX:0,progressBar:{bottom:0,left:0,width:0},shelf:{left:0,width:0}};this.showUIWhenInactive=this.$carousel.attr("data-show-ui-when-inactive")===
"false"?!1:!0;this.progressBarActive=this.$carousel.attr("data-progress-bar")==="false"?!1:!0;this.SLOT=this.getSlotNumber();this.INDEX=this.$carousel.index(".carousel");this.CLICKS={RIGHT_CLICKS:0,LEFT_CLICKS:0};this.STATUS={END:!1,BEGIN:!1,CLICKED:!1,SCROLLED:!1}},getSlotNumber:function(){for(var a=this.$items.find("a:first").attr("href"),a=a.slice(a.indexOf("?")+1).split("&"),b=0;b<a.length;b++){var c=a[b].split("=");if(c[0]==="pf_rd_s")return c[1].split("-").pop()}},updateRefTag:function(a){if(a&&
a.hasClass(this.CLASS.CONTROL))a.attr(this.ATTR.CONTROL_DIR)===this.DIR.RIGHT&&!this.STATUS.END&&this.CLICKS.RIGHT_CLICKS++,a.attr(this.ATTR.CONTROL_DIR)===this.DIR.LEFT&&!this.STATUS.BEGIN&&this.CLICKS.LEFT_CLICKS++,this.STATUS.CLICKED=!0;if(a&&a.hasClass(this.CLASS.PROGRESS_BAR))this.STATUS.SCROLLED=!0;else if(this.IS_TOUCH_ENABLED&&this.TOUCH.SCROLLED)this.STATUS.SCROLLED=!0;if(!this.STATUS.END)if(this.$rightArrow.hasClass(this.CLASS.CONTROL_INACTIVE))this.STATUS.END=!0;else if(this.IS_TOUCH_ENABLED)this.STATUS.END=
this.$shelf.width()-this.$carousel.scrollLeft()-this.$carousel.width()<=this.METRICS.TOUCH_START_END_THRESHOLD;if(!this.STATUS.BEGIN)if(this.$leftArrow.hasClass(this.CLASS.CONTROL_INACTIVE))this.STATUS.BEGIN=!0;else if(this.IS_TOUCH_ENABLED&&this.$carousel.scrollLeft()<=this.METRICS.TOUCH_START_END_THRESHOLD)this.STATUS.BEGIN=!0;a="";this.STATUS.CLICKED&&(a+="c");this.STATUS.END&&(a+="e");this.STATUS.BEGIN&&(a+="b");this.IS_TOUCH_ENABLED&&(a+="tg");this.STATUS.SCROLLED&&(a+="s");this.$progressBar.attr(this.ATTR.REF_TAG,
"dv_web_src_i"+this.INDEX+"_"+a+"_r"+this.CLICKS.RIGHT_CLICKS+"_l"+this.CLICKS.LEFT_CLICKS+"_s"+this.SLOT)},sendAnalytics:function(a){a!==null&&e.ajax({url:"/gp/video/ajax/storefront-analytics.html/ref="+a,data:{},dataType:"json",timeout:1E4})},bindEvents:function(){var a=this,b,c=!1,d=e("body");e("."+a.CLASS.CONTROL,a.$carousel).click(function(b){var c=e(this);a.$carousel.trigger(a.EVENTS.CHANGE_PAGE,{dir:c.attr(a.ATTR.CONTROL_DIR)});a.updateRefTag(c);b.preventDefault()});a.$carousel.bind(a.EVENTS.CHANGE_PAGE,
function(b,c){a.state.hasInteracted=!0;a.changePage(c.dir)});a.$progressBarScrubber.mousedown(function(b){b.which===1&&a.state.active&&(b.preventDefault(),a.startDrag(b.clientX))});var f;a.$carousel.bind("scroll",function(){j.clearTimeout(f);f=j.setTimeout(function(){a.TOUCH.SCROLLED=!0;a.updateRefTag()},a.METRICS.TOUCH_SCROLL_UPDATE_DELAY)});d.mousemove(function(b){a.state.isDragging&&(b.preventDefault(),a.drag(b.clientX))});d.mouseup(function(b){a.state.isDragging&&(b.preventDefault(),a.endDrag(),
a.updateRefTag(a.$progressBar),a.state.mouseOn||a.$progressBarScrubber.trigger("mouseleave"))});d.bind("mouseout",function(b){var c=!b.relatedTarget||b.relatedTarget.nodeName==="HTML";a.state.isDragging&&c&&(b.preventDefault(),a.endDrag(),a.state.mouseOn||a.$progressBarScrubber.trigger("mouseleave"))});g.bind("beforeunload",function(){a.sendAnalytics(a.$progressBar.attr(a.ATTR.REF_TAG))});a.$progressBarScrubber.bind("mouseenter",function(){a.state.mouseOn=!0;a.state.active&&a.wakeProgressBar()});
a.$progressBarScrubber.bind("mouseleave",function(){a.state.mouseOn=!1;!a.state.isDragging&&a.state.active&&a.sleepProgressBar()});g.resize(function(){a.resizeCarousel()});e(".aiv-container-limited").bind(a.EVENTS.CSS_TRANSITION_END,function(){a.resizeCarousel()});g.bind(a.EVENTS.CAROUSEL_DISPLAY,function(){a.$carousel.parents(":hidden").length||a.resetCarousel()});e("."+a.CLASS.CONTROL,a.$carousel).bind(a.EVENTS.CSS_TRANSITION_END,function(a){a.stopPropagation()});a.$carousel.find("img.lazy-load").load(function(){e(this).animate({opacity:1},
a.SPEED.LAZY_LOAD_IN,a.EASE.LAZY_LOAD_IN)});a.isCarouselVisible()?a.lazyLoadImages():(b=setInterval(function(){c&&(c=!1,a.isCarouselVisible()&&(b=j.clearInterval(b),a.lazyLoadImages()))},a.INTERVAL.PAGE_SCROLL),g.scroll(function(){c=!0}))},transitionProgressBar:function(a,b){b=b||this.SPEED.PAGE_TURN;this.$progressBarScrubber.animate({left:this.calcProgressBarLeftPercentage(a)+"%"},b,this.EASE.PAGE_TURN)},resetProgressBar:function(){this.$progressBarScrubber.css({left:this.calcProgressBarLeftPercentage()+
"%",width:this.calcProgressBarWidthPercentage()+"%"})},wakeProgressBar:function(){this.$progressBar.stop().animate(this.CSS.PROGRESS_BAR_WAKE,this.SPEED.CONTROLS_TOGGLE,this.EASE.PROGRESS_BAR_WAKE)},sleepProgressBar:function(){this.$progressBar.stop().animate(this.CSS.PROGRESS_BAR_SLEEP,this.SPEED.CONTROLS_TOGGLE,this.EASE.PROGRESS_BAR_WAKE)},setProgressBar:function(a,b,c){c?a.css(b):a.stop().animate(b,this.SPEED.CONTROLS_TOGGLE,this.EASE.CONTROLS_TOGGLE)},startDrag:function(a){var b=this.$progressBarScrubber.position().left;
this.state.isDragging=!0;g.trigger(this.EVENTS.START_DRAG);this.$progressBarScrubber.css({left:b});this.measurement.mouseX=a;this.measurement.progressBar.left=b},endDrag:function(){this.state.isDragging=!1;g.trigger(this.EVENTS.END_DRAG);this.measurement.mouseX=0;this.measurement.progressBar.left=0;this.transitionProgressBar()},convertProgressBarLeftPixelsToPercent:function(a){var b=0;return b=a/this.measurement.carousel.width*100},bounce:function(a,b){var c={},d={},c=this.isDirectionRight(b),d=this.$progressBarScrubber.width()*
this.DISTANCE.BOUNCE_BAR_OUT;c?(c={marginLeft:-this.DISTANCE.BOUNCE_SHELF_OUT},d={marginLeft:d}):(c={marginLeft:this.DISTANCE.BOUNCE_SHELF_OUT},d={marginLeft:-d});this.bounceAnimate(a,c,this.EASE.BOUNCE_PAGE_IN);this.bounceAnimate(this.$progressBarScrubber,d,this.EASE.BOUNCE_PAGE_IN)},bounceAnimate:function(a,b,c){var d=this;d.state.bounceLock=!0;a.animate(b,d.SPEED.BOUNCE_OUT,d.EASE.BOUNCE_OUT,function(){a.animate({marginLeft:0},d.SPEED.BOUNCE_IN,c,function(){d.state.bounceLock=!1})})},measureAll:function(){this.measureCarousel();
this.measureShelf()},measureCarousel:function(){this.measurement.carousel.width=this.$carousel.width();return this.measurement.carousel.width},measureShelf:function(){var a=this,b=0;a.$carousel.attr("data-elastic-items")==="true"&&a.setExplicitSizes();a.$items.each(function(c){var d=e(this),f=d.outerWidth();if(c===0)a.measurement.itemSpacing=d.outerWidth(!0)-f;a.measurement.itemWidths.push({left:b,width:f});b+=f+a.measurement.itemSpacing});a.measurement.shelf.width=b-a.measurement.itemSpacing;a.measurement.shelf.left=
0;a.EASE.PAGE_TURN=a.EASE.PAGE_TURN_DYNAMIC;a.SPEED.PAGE_TURN=a.SPEED.PAGE_TURN_DYNAMIC_MAX;a.IS_TOUCH_ENABLED&&a.$shelf.width(a.measurement.shelf.width+a.measurement.itemSpacing);return a.measurement.shelf.width},setExplicitSizes:function(){var a=this.$items.first();this.$items.css({display:"block",width:a.width(),height:a.height(),padding:0,marginRight:20,left:0,right:0});this.$shelf.css({width:99999})},resizeCarousel:function(){this.measureCarousel();typeof this.fixOutOfBounds==="function"&&this.fixOutOfBounds();
this.resetProgressBar();this.checkCarouselActive();this.checkBothArrows(this.measurement.shelf.left)},resetCarousel:function(){this.state.hasInteracted=!1;this.measureAll();this.resetProgressBar();this.resetPagination();this.checkCarouselActive();this.positionControls();this.checkBothArrows(this.measurement.shelf.left)},checkCarouselActive:function(){this.isShelfWiderThanCarousel()?this.activateCarousel():this.deactivateCarousel()},activateCarousel:function(a){this.state.active=!0;this.activateArrow(this.$rightArrow,
a);this.activateArrow(this.$leftArrow,a);this.setProgressBar(this.$barToHide,this.CSS.PROGRESS_BAR_SHOW,a)},deactivateCarousel:function(a){this.state.active=!1;this.deactivateArrow(this.$rightArrow,a);this.deactivateArrow(this.$leftArrow,a);this.setProgressBar(this.$barToHide,this.CSS.PROGRESS_BAR_HIDE,a);typeof this.fixOutOfBounds==="function"&&this.fixOutOfBounds()},createUI:function(){this.$rightArrow=this.createControl(this.DIR.RIGHT);this.$leftArrow=this.createControl(this.DIR.LEFT);this.hideLeftArrow();
this.createProgressBar();this.$carousel.parents(":hidden").length||this.positionControls();this.isShelfWiderThanCarousel()?this.state.active=!0:(this.state.active=!1,this.deactivateCarousel(!0));this.progressBarActive||this.$progressBarContainer.css({visibility:"hidden"})},createProgressBar:function(){var a=e("<div/>"),b;this.$progressBarScrubber=a.clone().addClass(this.CLASS.PROGRESS_BAR_SCRUBBER);this.$progressBar=a.clone().addClass(this.CLASS.PROGRESS_BAR).appendTo(this.$progressBarScrubber);b=
a.clone().addClass(this.CLASS.PROGRESS_BAR_TRACK);this.$progressBarContainer=a.clone().addClass(this.CLASS.PROGRESS_BAR_CONTAINER).append(b).append(this.$progressBarScrubber).appendTo(this.$carousel);this.resetProgressBar();this.showUIWhenInactive?(e.extend(this.CSS,this.CSS.PROGRESS_BAR_SEMI_HIDE_INACTIVE),this.$barToHide=this.$progressBarScrubber):(e.extend(this.CSS,this.CSS.PROGRESS_BAR_HIDE_INACTIVE),this.$barToHide=this.$progressBarContainer);this.measurement.progressBar.bottom=parseInt(this.$progressBarContainer.css("bottom"),
10)},createControl:function(a){var b=this.$carousel.find("a.carousel-"+a);b.length||(b=e("<a/>").addClass(this.CLASS.CONTROL+" carousel-"+a).attr("href","#").append(e("<i/>")),this.$carousel.append(b));b.attr(this.ATTR.CONTROL_DIR,a);return b},positionControls:function(){var a=this.$shelf.position().top+this.$shelf.height()/2;this.$rightArrow.add(this.$leftArrow).css({top:a-this.$rightArrow.height()/2})},lazyLoadImages:function(){var a=this.ATTR.IMG_DATA_SRC,b=this.ATTR.IMG_SRC;this.$shelf.find("img.lazy-load").each(function(){var c=
e(this),d=c.attr(a);typeof d==="string"&&c.attr(b,d)})},hideLeftArrow:function(){this.$leftArrow.css({left:-this.$leftArrow.width(),opacity:0})},activateArrow:function(a,b){var c={opacity:this.OPACITY.CONTROL_ACTIVE};if(a===this.$leftArrow){if(!this.state.hasInteracted)c.opacity=0;c.left=0}else c.right=0;a.removeClass(this.CLASS.CONTROL_INACTIVE);this.setArrow(a,c,b)},deactivateArrow:function(a,b){var c=a.width(),d={opacity:this.OPACITY.CONTROL_INACTIVE};if(!this.state.hasInteracted&&a===this.$leftArrow)d.opacity=
0;if(!this.showUIWhenInactive&&!this.state.active)if(d.opacity=0,a===this.$leftArrow)d.left=-c;else if(a===this.$rightArrow)d.right=-c;a.addClass(this.CLASS.CONTROL_INACTIVE);this.setArrow(a,d,b)},setArrow:function(a,b,c){c?a.css(b):a.stop().animate(b,this.SPEED.CONTROLS_TOGGLE,this.EASE.CONTROLS_TOGGLE)},checkBothArrows:function(a){a=a||this.measurement.shelf.left;this.checkArrow(this.isFirstPage(a),this.$leftArrow);this.checkArrow(this.isLastPage(a),this.$rightArrow)},checkArrow:function(a,b){a?
this.deactivateArrow(b):this.activateArrow(b)},calcMinShelfOffset:function(){return 0},calcMaxShelfOffset:function(){return this.measurement.shelf.width-this.measurement.carousel.width},calcShelfLeftFromPercentage:function(a){return this.measurement.shelf.width*(a/100)},calcMinProgressBarLeft:function(){return 0},calcMaxProgressBarLeft:function(){return 100-this.measurement.progressBar.width},calcDelta:function(a){return this.isDirectionRight(a)?1:-1},isCarouselVisible:function(){var a=!1,b=g.height(),
c=g.scrollTop();b+c>this.measurement.carousel.topOffset&&(a=!0);return a},isDirectionRight:function(a){return a===this.DIR.RIGHT},isShelfWiderThanCarousel:function(a,b){var c=!0,a=a||this.measurement.shelf.width,b=b||this.measurement.carousel.width;return b===0?!1:a>b},changePage:function(a){var b=this.measurement.shelf.left,c=0;(this.isDirectionRight(a)?this.isLastPage(b):this.isFirstPage(b))?this.state.bounceLock||this.bounce(this.$shelf,a):(c=this.calcNextPage(b,a),this.scrollToTargetLeft(c),this.reactivateButtonsAfterScrolling(a))},
scrollToItem:function(a){var b;b=this.calcMaxShelfOffset();var c;this.state.hasInteracted=!0;c=this.measurement.shelf.left;a=this.measurement.itemWidths[a].left;b=a<b?a:b;this.scrollToTargetLeft(b);this.reactivateButtonsAfterScrolling(b<c?this.DIR.LEFT:this.DIR.RIGHT)},scrollToTargetLeft:function(a){var b=this.calcSpeedByDistance(this.measurement.shelf.left,a);this.measurement.shelf.left=a;this.transitionPage(a,b);this.transitionProgressBar(a,b)},reactivateButtonsAfterScrolling:function(a){this.isDirectionRight(a)&&
this.state.hasInteracted?(this.activateArrow(this.$leftArrow),this.isLastPage(this.measurement.shelf.left)&&this.deactivateArrow(this.$rightArrow)):(this.activateArrow(this.$rightArrow),this.isFirstPage(this.measurement.shelf.left)&&this.deactivateArrow(this.$leftArrow))},findClosestItem:function(a,b){for(var c=this.isDirectionRight(b),d=this.measurement.itemWidths.length,f=0,g=0,e=c?-1:0,h=0,i=!1,j=g=!1;h<d;h++)if(g=this.measurement.itemWidths[h].left,i=g>a,g=g===a,j=h===d-1,i||!c&&(g||j)){f=this.measurement.itemWidths[h+
e].left;break}else if(j){f=this.measurement.itemWidths[h].left;break}return f},transitionPage:function(a,b){b=b||this.SPEED.PAGE_TURN;this.$shelf.animate({left:-a},b,this.EASE.PAGE_TURN);this.state.outOfBounds=!1},fixOutOfBounds:function(){var a=this.measurement.shelf.left;this.isFirstPage(a)?this.setShelfLeft(this.calcMinShelfOffset()):this.isLastPage(a)&&this.setShelfLeft(this.calcMaxShelfOffset())},resetPagination:function(){this.setShelfLeft(this.calcMinShelfOffset())},setShelfLeft:function(a){this.measurement.shelf.left=
a;this.$shelf.css({left:-a})},drag:function(a){var b=this.measurement.progressBar.left+(a-this.measurement.mouseX),c=this.convertProgressBarLeftPixelsToPercent(b),d=this.calcMinProgressBarLeft(),f=this.calcMaxProgressBarLeft();this.state.hasInteracted?(c<=d?(c=d,this.$leftArrow.hasClass(this.CLASS.CONTROL_INACTIVE)||this.deactivateArrow(this.$leftArrow)):this.$leftArrow.hasClass(this.CLASS.CONTROL_INACTIVE)&&this.activateArrow(this.$leftArrow),c>=f?(c=f,this.$rightArrow.hasClass(this.CLASS.CONTROL_INACTIVE)||
this.deactivateArrow(this.$rightArrow)):this.$rightArrow.hasClass(this.CLASS.CONTROL_INACTIVE)&&this.activateArrow(this.$rightArrow)):(this.state.hasInteracted=!0,this.activateArrow(this.$leftArrow));this.$progressBarScrubber.stop().css({left:c+"%"});this.setShelfLeft(this.calcShelfLeftFromPercentage(c));this.measurement.mouseX=a;this.measurement.progressBar.left=b},calcIdealLeft:function(a,b){var c=0;return c=b===this.DIR.RIGHT?a+this.measurement.carousel.width+this.measurement.itemSpacing:a-this.measurement.carousel.width-
this.measurement.itemSpacing},calcNextPage:function(a,b){var c=this.isLastPage(a),d=this.isDirectionRight(b),f=d?this.calcMaxShelfOffset():this.calcMinShelfOffset(),c=this.findClosestItem(this.calcIdealLeft(c?this.findClosestItem(a,this.DIR.LEFT):a,b),b);return c=(d?this.isLastPage(c):this.isFirstPage(c))?f:c},calcProgressBarLeftPercentage:function(a){var b=0;if(typeof a!=="number")a=this.measurement.shelf.left;return b=a/this.measurement.shelf.width*100},calcProgressBarWidthPercentage:function(){var a=
this.measurement.carousel.width/this.measurement.shelf.width*100;return this.measurement.progressBar.width=a},calcSpeedByDistance:function(a,b){var c=this.SPEED.PAGE_TURN,d=this.SPEED.PAGE_TURN_DYNAMIC_MIN,c=d+Math.abs((c-d)*((b-a)/this.measurement.carousel.width));return parseInt(c,10)},isFirstPage:function(a){return a<=this.calcMinShelfOffset()},isLastPage:function(a){return a>=this.calcMaxShelfOffset()}};d.length&&d.each(function(){var a=e(this);a.addClass("carousel-loaded");c&&a.attr("data-context-touch-available")===
"true"&&a.addClass("carousel-touch");new b(a)});return b});i.when("A").register("dv-easing",function(d){var e=d.$;e.easing.jswing=e.easing.swing;e.extend(e.easing,{def:"easeOutQuad",swing:function(d,c,f,b,a){return e.easing[e.easing.def](d,c,f,b,a)},easeInQuad:function(d,c,f,b,a){return b*(c/=a)*c+f},easeOutQuad:function(d,c,f,b,a){return-b*(c/=a)*(c-2)+f},easeInOutQuad:function(d,c,f,b,a){return(c/=a/2)<1?b/2*c*c+f:-b/2*(--c*(c-2)-1)+f},easeInCubic:function(d,c,f,b,a){return b*(c/=a)*c*c+f},easeOutCubic:function(d,
c,f,b,a){return b*((c=c/a-1)*c*c+1)+f},easeInOutCubic:function(d,c,f,b,a){return(c/=a/2)<1?b/2*c*c*c+f:b/2*((c-=2)*c*c+2)+f},easeInQuart:function(d,c,f,b,a){return b*(c/=a)*c*c*c+f},easeOutQuart:function(d,c,f,b,a){return-b*((c=c/a-1)*c*c*c-1)+f},easeInOutQuart:function(d,c,f,b,a){return(c/=a/2)<1?b/2*c*c*c*c+f:-b/2*((c-=2)*c*c*c-2)+f},easeInQuint:function(d,c,f,b,a){return b*(c/=a)*c*c*c*c+f},easeOutQuint:function(d,c,f,b,a){return b*((c=c/a-1)*c*c*c*c+1)+f},easeInOutQuint:function(d,c,f,b,a){return(c/=
a/2)<1?b/2*c*c*c*c*c+f:b/2*((c-=2)*c*c*c*c+2)+f},easeInCirc:function(d,c,f,b,a){return-b*(Math.sqrt(1-(c/=a)*c)-1)+f},easeOutCirc:function(d,c,f,b,a){return b*Math.sqrt(1-(c=c/a-1)*c)+f},easeOutElastic:function(d,c,f,b,a){var d=1.70158,l=0,e=b;if(c===0)return f;if((c/=a)===1)return f+b;l||(l=a*0.3);e<Math.abs(b)?(e=b,d=l/4):d=l/(2*Math.PI)*Math.asin(b/e);return e*Math.pow(2,-10*c)*Math.sin((c*a-d)*2*Math.PI/l)+b+f},easeInBack:function(d,c,f,b,a,l){l===s&&(l=1.70158);return b*(c/=a)*c*((l+1)*c-l)+
f},easeOutBack:function(d,c,f,b,a,l){l===s&&(l=1.70158);return b*((c=c/a-1)*c*((l+1)*c+l)+1)+f},easeInOutBack:function(d,c,f,b,a,l){l===s&&(l=1.70158);return(c/=a/2)<1?b/2*c*c*(((l*=1.525)+1)*c-l)+f:b/2*((c-=2)*c*(((l*=1.525)+1)*c+l)+2)+f},easeOutBounce:function(d,c,f,b,a){return(c/=a)<1/2.75?b*7.5625*c*c+f:c<2/2.75?b*(7.5625*(c-=1.5/2.75)*c+0.75)+f:c<2.5/2.75?b*(7.5625*(c-=2.25/2.75)*c+0.9375)+f:b*(7.5625*(c-=2.625/2.75)*c+0.984375)+f}})});var d=j.amznAIV||{};d.logShelfRendered=function(h){typeof d.shelvesRendered===
"undefined"?d.shelvesRendered=[h]:d.shelvesRendered.push(h)};j.amznAIV=d})})(function(){var i=window.AmazonUIPageJS||window.P,j=i._namespace||i.attributeErrors;return j?j("DigitalVideoCarouselAUI"):i}(),window);
(function(i,j,s){i.execute(function(){i.when("A","dv-modal","dv-util-reload-box").register("dv-download-box",function(d){var h=d.$,e={isDebug:!1,confirmSdDownloadId:"dv-modal-download-in-sd",confirmRentalDownloadId:"dv-modal-download-rental"},g="dv:modal:click:submit:"+e.confirmSdDownloadId,c="dv:modal:click:submit:"+e.confirmRentalDownloadId,f={init:function(){this.options=e;this.initDefaults();this.bindEvents()},initDefaults:function(){this.currentMessage="";this.messageSpeed=300;this.errorID={prefix:"dv-do-msg-",
hdAsSd:"hd-as-sd"};this.hideElement={opacity:0,height:0,paddingTop:0,paddingBottom:0};this.pri={success:"success",warning:"warning",error:"error"};this.confirmedRentalDownload=this.confirmedHdDownloadAsSd=!1},bindEvents:function(){var b=this;h("body").delegate("form.dv-do-format-select","submit",function(a){var c=h(this);b.checkRequest(c);a.preventDefault()});h("body").delegate("#begin-sd-download","click",function(a){b.activeForm&&b.checkRequest(b.activeForm.$form,!0);a.preventDefault()});d.on(g,
function(){b.log("confirmSdDownload happened!");d.trigger("dv:modal:close");b.confirmedHdDownloadAsSd=!0;b.activeForm&&b.checkRequest(b.activeForm.$form,!0)});d.on(c,function(){b.log("confirmRentalDownload happened!");d.trigger("dv:modal:close");b.confirmedRentalDownload=!0;b.activeForm&&b.checkRequest(b.activeForm.$form,!0)})},getSelectedDeviceElement:function(b){var a=b.find("option:selected"),b=b.find('input[name="device"]');return a.length>0?a:b},checkDevice:function(b){b=this.getSelectedDeviceElement(b);
this.hideMessage();b.attr("data-hd-as-sd")==="1"&&this.generateMessage(this.errorID.hdAsSd,this.pri.warning)},generateMessage:function(b,a,c){var d=this,a={id:b,priority:a,message:c},c=c||"";h.get("/gp/video/widgets/download-box/ajax/status-message.html",a,function(a){d.hideMessage();d.currentMessage=b;d.showMessage(a)})},showMessage:function(b){var b=h(b),a={};h("form.dv-do-format-select").after(b);b.css("height","auto");a={opacity:1,height:b.height(),paddingTop:b.css("padding-top"),paddingBottom:b.css("padding-top")};
b.css(this.hideElement).animate(a,this.messageSpeed)},hideMessage:function(){var b=this,a=h("div.dv-download-options").find("div.dv-do-state-message");a.animate(b.hideElement,b.messageSpeed,function(){b.currentMessage="";a.remove()})},checkRequest:function(b){var a=this,c={$form:b,$submitButton:b.find("button.dv-do-download-submit"),$device:a.getSelectedDeviceElement(b)},d=c.$device.val().split("+"),f={deviceID:d[0],asin:d[1],availableDownloads:b.data("available-downloads"),downloadData:c.$device.data("download")||
{},deviceName:c.$device.text()},b={};f.HDDownloadAsSD=f.downloadData.isSdDownload==="1"?1:0;f.isRental=f.downloadData.isRental===1?1:0;a.formData=f;a.activeForm=c;if(a.canStartDownload()&&d.length===2)a.disableSubmit(c.$submitButton),b={asin:f.asin,client:f.deviceID,isSDDownload:f.HDDownloadAsSD,jsonSubmit:1},d=f.downloadData.refTag,h.post("/gp/video/widgets/download-box/ajax/download.html/ref="+d,b,function(b){a.enableSubmit(c.$submitButton);b.success?a.downloadSuccess(b.message,c):a.downloadError(b.message)},
"json")},canStartDownload:function(){if(this.formData.HDDownloadAsSD&&!this.confirmedHdDownloadAsSd)return this.showSdModal(),!1;return this.formData.isRental&&!this.confirmedRentalDownload?(this.showRentalModal(),!1):!0},showSdModal:function(){d.trigger("dv:modal:show",{id:this.options.confirmSdDownloadId})},showRentalModal:function(){d.trigger("dv:modal:show",{id:this.options.confirmRentalDownloadId,templatingArgs:{deviceName:this.formData.deviceName}})},downloadSuccess:function(b,a){this.decreaseCounter(a);
this.formData&&this.formData.isRental&&this.formData.asin?d.trigger("dv:pd:sidebox:trigger:refresh",this.formData.asin):b&&this.generateMessage("","success",b)},downloadError:function(b){b&&this.generateMessage("","error",b)},decreaseCounter:function(b){var a=b.$form.parents("div.dv-download-options").find(".dv-toggle-link").children("span.js-available-count"),c;c=parseInt(a.text(),10);c>=1&&(c-=1);c<=0&&this.hideForm(b);a.text(c)},hideForm:function(b){b.$form.css({overflow:"hidden"}).animate({opacity:0,
height:0},this.messageSpeed)},disableSubmit:function(b){b.attr("disabled",!0)},enableSubmit:function(b){b.attr("disabled",!1)},log:function(){var b=j.console&&j.console.log&&typeof j.console.log==="function";this.options&&this.options.isDebug&&b&&(b=Array.prototype.slice.call(arguments),j.console.log.apply(j.console,b))}};f.init();return f});i.when("A","ready").register("dv-buy-box",function(d){var h=d.$,e={},g={},c={init:function(){e=d.state("dv-buy-box")||{};g=e.purchaseStatus;this.addEventListeners()},
addEventListeners:function(){var c=this;d.on("dv:buybox:status:changed",function(b){c.updateStatus(b)})},updateStatus:function(c){h("#purchase-status").html(g[c])}};c.init();return c});i.when("A","jQuery","logging","js-modal").register("dv-purchase-modal",function(d,h,e,g){function c(a){var c=a.id,e=a.asins,m=h.extend(!0,{},{showCloseButton:!1,footer:{submitButton:{customEvent:"dv:purchase:modal:submit",eventArgs:{asins:e,id:c,continuePurchaseOnSubmit:a.continuePurchaseOnSubmit,retryPurchaseOnSubmit:a.retryPurchaseOnSubmit,
cancelPurchaseOnSubmit:a.cancelPurchaseOnSubmit}},cancelButton:{customEvent:"dv:purchase:modal:cancel",eventArgs:{asins:e,id:c,cancelPurchaseOnCancel:typeof a.cancelPurchaseOnCancel!=="undefined"?a.cancelPurchaseOnCancel:1}},checkBox:{customEvent:"dv:modal:checkbox:checked",eventArgs:{id:c,elemId:c+"-check"}}}},a);b.log("dv:purchase:modal:show happened with args",a,m);d.on("a:popover:beforeHide:"+c,function(a){a=a.popover||{};b.log("a:popover:beforeHide:"+a.name+" happened",a);d.off("a:popover:beforeHide:"+
a.name);d.trigger("dv:purchase:cancel",{asins:e})});return f=g.create(m)}var f,b=e.create("dv-purchase-modal");d.on("dv:purchase:modal:submit",function(a){b.log("dv:purchase:modal:submit happened with args:",a);d.off("a:popover:beforeHide:"+a.id);f&&f.hide();a.continuePurchaseOnSubmit?d.trigger("dv:purchase:continue",a):a.retryPurchaseOnSubmit?d.trigger("dv:purchase:retry",a):a.cancelPurchaseOnSubmit?d.trigger("dv:purchase:cancel",a):a.refreshPageOnSubmit&&j.location.reload(!0)});d.on("dv:purchase:modal:cancel",
function(a){b.log("dv:purchase:modal:cancel happened with args:",a);d.off("a:popover:beforeHide:"+a.id);a.cancelPurchaseOnCancel&&d.trigger("dv:purchase:cancel",a);f&&f.hide()});d.on("dv:modal:checkbox:checked",function(a){var b=h("#"+a.elemId).find("input[type='checkbox']");b.prop("disabled")||(b.prop("disabled",!0),h.ajax({url:a.url,data:a,dataType:"json",type:"POST",success:function(c){c.success||b.prop("checked",a.checked?!1:!0)},error:function(){b.prop("checked",a.checked?!1:!0)},complete:function(){b.prop("disabled",
!1)}}))});d.on("dv:purchase:modal:show",function(a){(f=c(a))&&f.show()});return{create:function(a){return c(a)}}});i.when("A","logging","dv-pin-controller","dv-ajax-purchase","js-modal","dv-buy-box","dv-purchase-modal").register("dv-purchase",function(d,h,e,g){var c=d.$,f,b=h.create("dv-purchase"),h={init:function(){f=e.create(d.state("dv-pin-config")||{});this.addEventListeners();this.checkPurchaseTriggers();b.log("[dv-purchase] init happened pinCheck:",f)},addEventListeners:function(){var a=this;
b.log("[dv-purchase] addEventListeners");d.on("dv:purchase:generic:error",function(c){b.log("dv:purchase:generic:error happened with args:",c);a.showGenericError(c)});d.on("dv:purchase:continue",function(c){b.log("dv:purchase:continue happened with args:",c);a.continuePurchase(c)});d.on("dv:purchase:cancel",function(c){b.log("dv:purchase:cancel happened with args:",c);a.cancelPurchase(c)});d.on("dv:purchase:reload",function(c){b.log("dv:purchase:reload happened with args:",c);a.reload(c)});d.on("dv:purchase:retry",
function(c){b.log("dv:purchase:retry happened with args:",c);a.retryPurchase(c)});d.on("dv:dp:purchase:update:payment",function(c){b.log("dv:dp:purchase:update:payment happened with args:",c);a.retryPurchase(c)});d.on("dv:modal:purchase:from:stage",function(c){b.log("Purchase from stage happened with args:",c);a.purchaseFromStage(c)});f.on("success",function(c){b.log("Pin Check Success happened with args:",c);a.continuePurchase(c)});f.on("pinAuthFailure",function(c){b.log("Pin Check Failure happened with args:",
c);a.cancelPurchase(c)})},purchaseStart:function(a){b.log("[dv-purchase] purchaseStart asin:",a);j.showSpinner();j.avodPurchase.purchaseStart(a)},continuePurchase:function(a){b.log("continuePurchase args",a);j.avodPurchase.purchaseContinue(a.asins,a)},purchaseFromStage:function(a){var c=a.stage,f=a.asin;b.log("purchaseFromStage args",a);d.trigger("dv:modal:close");j.showSpinner();j.avodPurchase.setStage(f,c);j.avodPurchase.currentStage(f,a)},cancelPurchase:function(a){b.log("cancelPurchase args",
a);j.avodPurchase&&(j.avodPurchase.purchaseCancel(a.asins),d.trigger("dv:buybox:status:changed","cancelPurchase"))},reload:function(a){b.log("reload args",a);j.avodPurchase&&(j.avodPurchase.reload(a),d.trigger("dv:buybox:status:changed","reload"))},retryPurchase:function(a){b.log("retryPurchase args",a);j.avodPurchase.purchaseRetry(a.asins)},showDefaultDialog:function(a){var c={id:a.id,asins:a.asins,continuePurchaseOnSubmit:!0,cancelPurchaseOnCancel:!0,ajaxParameters:{ASINS:a.asins}};b.log(a.id+" modalArgs",
c);a.status&&d.trigger("dv:buybox:status:changed",a.status);d.trigger("dv:purchase:modal:show",c)},showBlackoutWarning:function(a){this.showDefaultDialog({id:"dv-modal-blackout",asins:a,status:"blackoutWarning"})},showTVPassWarning:function(a){this.showDefaultDialog({id:"dv-modal-tvpass",asins:a,status:"confirmTVPassTerms"})},showGeoCheck:function(a){a={id:"dv-modal-geocheck",asins:a,retryPurchaseOnSubmit:!0,cancelPurchaseOnCancel:!0,ajaxParameters:{ASINS:a}};b.log("showGeoCheck modalArgs",a);d.trigger("dv:buybox:status:changed",
"checkingLocation");d.trigger("dv:purchase:modal:show",a)},purchaseTimeout:function(){i.when("A","dv-modal").execute(function(a){a.trigger("dv:modal:show",{id:"dv-modal-purchase-timeout",footer:{submitButton:{customEvent:"dv:modal:close",eventArgs:{id:"dv-modal-purchase-timeout"}}}})})},purchaseError:function(a){a={id:"dv-modal-purchase-error",retryPurchaseOnSubmit:!0,cancelPurchaseOnCancel:!0,asins:a};b.log("purchaseError modalArgs",a);d.trigger("dv:purchase:modal:show",a)},duplicatePurchase:function(){i.when("A",
"dv-modal").execute(function(a){a.trigger("dv:modal:show",{id:"dv-modal-duplicate-purchase",footer:{submitButton:{customEvent:"dv:modal:close",eventArgs:{id:"dv-modal-duplicate-purchase"}}}})})},pinAuthenticationFailure:function(){i.when("A","dv-modal").execute(function(a){var c={id:"dv-modal-pin-auth-failure",footer:{submitButton:{customEvent:"dv:modal:close",eventArgs:{id:"dv-modal-pin-auth-failure"}}}};b.log("[dv-purchase] pinAuthenticationFailure:",c);a.trigger("dv:modal:show",c)})},showPlaybackWarning:function(a){this.showDefaultDialog({id:"dv-modal-playback-warning",
asins:a,status:"checkingPlugins"})},warnPlayerRequiredPluginMissing:function(a){this.showDefaultDialog({id:"dv-modal-playback-plugin-missing",asins:a,status:"checkingPlugins"})},pinCheck:function(a){f.handleAsinAuthorization(a)},getPinAuthenticationToken:function(a){return(a=f.getAsinStatus(a))&&a.getStatus()==="AUTHORIZED"?a.getToken():s},showHDContentWarning:function(a){this.showDefaultDialog({id:"dv-modal-hd-content-warning",asins:a,status:"checkingPlugins"})},showHDCPContentWarning:function(a){this.showDefaultDialog({id:"dv-modal-hdcp-content-warning",
asins:a,status:"checkingPlugins"})},showGenericError:function(a){d.trigger("dv:purchase:modal:show",{id:"dv-modal-generic-error",retryPurchaseOnSubmit:!1,cancelPurchaseOnCancel:!0,ajaxParameters:{errorMsg:a||""}})},createOrder:function(a,b){i.when("a-state").execute(function(){var c=d.state("dv-dp-purchase-data")||{},c={endpoint:c.createOrderUrl,callData:{asin:a,csrfToken:c.csrfToken},asins:a},f=b&&b.token;if(f)c.callData.pinToken=f;g.create(c).callPurchase()})},validateOrder:function(a,b){i.when("a-state").execute(function(){var c=
{endpoint:(d.state("dv-dp-purchase-data")||{}).checkStatusUrl,isOrderStatusCheck:!0,callData:{asin:a,orderToken:b},asins:a};g.create(c).callPurchase()})},validateActionToken:function(a){i.when("a-state").execute(function(){var f=a.asin,g=a.token,e=d.state("dv-dp-purchase-data")||{};b.log("[purchase] validateActionToken state",f,g,e);c.ajax({url:e.validateTokenUrl,data:{purchasetoken:g},success:function(c){b.log("[purchase] validateActionToken success",c,a);c.success&&a.callback&&a.callback(f)},error:function(a){b.log("[purchase] validateActionToken error",
a)},dataType:"json"})})},checkPurchaseTriggers:function(){var a=this;b.log("[purchase] checkPurchaseTriggers");i.when("a-state").execute(function(){var c=d.state("dv-dp-purchase-data")||{},f=c.purchaseAsin,g=c.purchaseToken,e=c.orderToken,c=c.triggerPurchase;b.log("[purchase] checkPurchaseTriggers state",f,g,e);c&&g&&(f||e)&&a.validateActionToken({asin:f,token:g,callback:function(){a.purchaseStart(f)}})})},showContinuePurchaseDialog:function(a){i.when("A","dv-modal","a-state").execute(function(b){var c=
b.state("dv-dp-purchase-data")||{};b.trigger("dv:modal:show",{id:"dv-continue-purchase",footer:{submitButton:{customEvent:"dv:modal:purchase:from:stage",eventArgs:{stage:c.orderToken?j.avodPurchase.VALIDATE_ORDER:j.avodPurchase.CREATE_ORDER,asin:a.asin}}}})})}};h.init();return h});i.when("A","jQuery","logging","dv-purchase-modal").register("dv-purchase-fix-up-flows",function(d,h,e,g){var c=e.create("dv-purchase-fix-up-flows"),f;return{fix:function(b){c.log("[fixUp] errorAction:",b);if(b)b.modal?(c.log("[fixUp] _actionModal:",
b),f=g.create(b.modal),f.show()):b.redirectUrl?(c.log("[fixUp] _actionRedirect args:",b),j.location.href=b.redirectUrl):(c.log("[fixUp] _generalError args:",b),f=g.create({id:"dv-modal-generic-error",cancelPurchaseOnSubmit:!0}),f.show())}}});i.when("A","logging","dv-purchase-fix-up-flows","dv-client-side-metrics").register("dv-ajax-purchase",function(d,h,e,g){var c=d.$,f=h.create("dv-ajax-purchase"),b={endpoint:"/gp/video/order/create-order.html",ajaxDataType:"jsonp",ajaxRetries:3,callData:s,isOrderStatusCheck:!1},
a=g.create({scope:"dvweb:buybox:purchase"}),l=g.create({scope:"dvweb:buybox:orderAction"}),n=g.create({scope:"dvweb:buybox:polling"}),m="";return{create:function(g){var h={},i=function(b){var c=b.action,g=b.orderToken;if(g)h.callData.orderToken=g;if(c&&c.modal)c.modal.asins=m;f.log("[ajaxPurchase] ajaxSuccess",b);switch(b.status){case "SUCCESS":h.isOrderStatusCheck?l.ajaxSuccess({requestId:b.requestId}):a.ajaxSuccess({requestId:b.requestId});d.trigger("dv:purchase:continue",{orderToken:g,asins:h.asins});
h.isOrderStatusCheck?l.ajaxDone():a.ajaxDone();break;case "PENDING":n.counter("dvweb:checkOrderStatus:polling");d.delay(j,c.delay);break;case "ERROR":e.fix(c);break;default:e.fix(c)}},j=function(b){m=h.callData.asin;a.ajaxStart();c.ajax(h.endpoint,{data:h.callData,dataType:h.ajaxDataType,type:"POST",success:i,error:function(){b=b||0;b<h.ajaxRetries?j(++b):d.trigger("dv:purchase:generic:error","[PURCHASE_HTTP_TIMEOUT]")}})};c.extend(!0,h,b,g);return{callPurchase:function(a){if(a)h.callData=a;!h.callData&&
(!h.callData.orderToken||!h.callData.asin||!h.callData.offerToken)&&d.trigger("dv:purchase:generic:error","[PURCHASE_MALFORMED_ARGS]");j()}}}}});i.when("A","logging","ready","dv-modal").execute(function(d,h){var e=d.$,g=h.create("feedback-form-js");({init:function(){this.id="dv-feeback-modal";this.$el=e("#"+this.id);this.addEventListeners()},addEventListeners:function(){var c=this;d.on("a:dropdown:selected:topic",function(){e("#aiv-dp-feedback-hidden-area").show();e(".dv-dp-form-error").slideUp();
e(".feedback-hidden-links").hide();var c="#helplink-"+e("#aiv-dp-feedback-topics").val();e(c).show()});d.on("dv:modal:click:submit:"+c.id,function(){(e("#aiv-dp-feedback-hidden-area").length===0||e("#aiv-dp-feedback-hidden-area").is(":visible"))&&c.submit()})},submit:function(){var c,f;this.$form=e("#dp-feedback-form");c=this.$form.attr("action");e(".dv-dp-form-error").hide();e("#dp-fb-success-changeover").hide();this.setHiddenFields();f=this.assembleFormData();g.log("[feedbackForm] submit",f);f.comments.length?
(e.ajax({type:"POST",url:c,data:f}),d.trigger("dv:modal:close"),e("#dp-fb-success-changeover").show()):e(".dv-dp-form-error").slideDown()},setHiddenFields:function(){this.hiddenFieldData=[{name:"sourceURL",value:this.getURL()},{name:"operatingSystem",value:this.getOS()},{name:"browser",value:this.getBrowser()}]},assembleFormData:function(){var c={},d,b;d=this.$form.find("input:text, input:hidden, textarea");b=this.$form.find("input:radio:checked");d.each(function(){var a=e(this);c[a.attr("name")]=
a.val()});b.each(function(){var a=e(this);c[a.attr("name")]=a.val()});c.topic=e("#aiv-dp-feedback-topics").val();e.each(this.hiddenFieldData,function(a,b){c[b.name]=b.value});return c},getURL:function(){return String(document.location.href)},getOS:function(){var c="Unknown OS";navigator.appVersion.indexOf("Win")!==-1?c="Windows":navigator.appVersion.indexOf("Mac")!==-1?c="MacOS":navigator.appVersion.indexOf("X11")!==-1?c="UNIX":navigator.appVersion.indexOf("Linux")!==-1&&(c="Linux");return c},getBrowser:function(){return navigator.userAgent}}).init()});
i.when("A","ready").register("dv-fsk18-modal",function(d){var h=d.$,e=d.state("dv-dp-fsk18-state")||{},g={init:function(){this.addEventListeners();e.autoPlayAttempted&&e.playableAsin&&this.showAgeVerificationModal(e.playableAsin)},addEventListeners:function(){d.on("dv:fsk18:modal:show",function(c){var f=c.id,b=c.asins,c=h.extend(!0,{},{showCloseButton:!1,footer:{submitButton:{customEvent:"dv:fsk18:modal:submit",eventArgs:{asins:b,id:f}},cancelButton:{customEvent:"dv:fsk18:modal:cancel",eventArgs:{asins:b,
id:f,cancelPurchaseOnCancel:c.cancelPurchaseOnCancel}}}},c);d.trigger("dv:modal:show",c)});d.on("dv:fsk18:modal:cancel",function(c){c.cancelPurchaseOnCancel&&d.trigger("dv:purchase:cancel",c);d.trigger("dv:modal:close",c)});d.on("dv:fsk18:modal:submit",function(c){var f=e.fsk18RedirectUrl?e.fsk18RedirectUrl:"",f=f.replace("FSK18ASIN",c.asins);d.off("a:popover:beforeHide:"+c.id);d.trigger("dv:modal:close",c);j.location.href=f})},showAgeVerificationModal:function(c){d.trigger("dv:fsk18:modal:show",
{id:"dv-age-verification-dialog",asins:c,cancelPurchaseOnCancel:!0})}};g.init();return g});i.when("A","dv-alerts","dv-async","dv-modal","dv-breeze").register("dv-gift-card",function(d,h,e){var g=d.$,c=e.create("dv-gift-card",i),e={states:{RUNNING:2,READY:1},currentState:null,init:function(){this.id="dv-gift-card";this.addEventListeners();this.currentState=this.states.READY},addEventListeners:function(){var c=this;g("body").delegate("#gc-giftcard","submit",function(b){b.preventDefault();c.submit()});
d.on("a:popover:ajaxSuccess:"+c.id,function(){c.updateGCBalances()});d.on("dv:modal:click:submit:"+c.id,function(){c.submit()})},submit:function(){var d=this,b,a,e={retJSON:!0};if(d.currentState!==d.states.RUNNING)d.currentState=d.states.RUNNING,b=g("#gc-giftcard"),a=b.attr("action"),e.code=b.find(".dv-gc-text-input").val(),c.ajax(a,{params:e,success:function(a){(a.gcIsProcess||"-1")==="1"?(d.updateGCBalances(),d.updateModalSuccess(a)):d.updateModalFailure(a);d.currentState=d.states.READY},error:function(a){d.updateModalFailure(a);
d.currentState=d.states.READY}})},updateModalFailure:function(c){c&&c.message&&this.showMessage(g(h.error(c.message,"block","light")))},updateModalSuccess:function(c){c&&c.message&&this.showMessage(g(h.success(c.message,"block","light")))},showMessage:function(c){g("#gc-message-wrapper")[0]||this.addMessageWrapper();g("#gc-message-wrapper").dv_breezeIn({content:c,flush:!0})},addMessageWrapper:function(){g("<div/>").attr({id:"gc-message-wrapper"}).insertAfter(g("#gc-giftcard"))},updateGCBalances:function(){d.ajax("/gp/video/usdvm/pop-overs/unbox-process-gc-promo.html?getBalance=1&showMobileApps=1&useAUI=1",
{method:"post",success:function(c){g(".gc-balances").html(c)}})}};e.init();return e});i.when("jQuery").register("dv-offset",function(d){d.fn.extend({dvOffset:function(h){if(arguments.length)return h===s?this:this.each(function(a){d.offset.setOffset(this,h,a)});var e,g,c,f,b,a={top:0,left:0};if(f=(c=this[0])&&c.ownerDocument){if((g=f.body)===c)return d.offset.bodyOffset(c);e=f.documentElement;if(!d.contains(e,c))return a;typeof c.getBoundingClientRect!=="undefined"&&(a=c.getBoundingClientRect());c=
d.isWindow(f)?f:f.nodeType===9?f.defaultView||f.parentWindow:!1;f=e.clientTop||g.clientTop||0;g=e.clientLeft||g.clientLeft||0;b=c.pageYOffset||e.scrollTop;return{top:a.top+b-f,left:a.left+(c.pageXOffset||e.scrollLeft)-g}}}})});i.when("A","logging","dv-ready-atf").register("dv-modal",function(d,h){var e=d.$,g=h.create("dv-modal"),c={isDebug:!1,width:400},f={init:function(){g.log("[MODAL] init");this.submitTemplate=e("#SubmitTemplate").html();this.cancelTemplate=e("#CancelTemplate").html();this.checkBoxTemplate=
e("#CheckBoxTemplate").html();this.options=e.extend({},c);this.addEventListeners()},addEventListeners:function(){var b=this;g.log("[MODAL] addEventListeners");d.declarative("dv-modal","click",function(a){var c=a.data;g.log("[MODAL] triggered dv:modal:declarative click",a);c.id=a.$target.attr("id");b.initModal(c)});d.on("dv:modal:show",function(a){g.log("[MODAL] triggered dv:modal:show",a);b.initModal(a)});d.on("dv:modal:close",function(a){var c=a&&a.id?a.id:b.id;g.log("[MODAL] triggered dv:modal:close",
a);b.removeEventListeners();b.hideModal(c)})},initModal:function(b){var a={},d=b.selector||"#"+b.id,f=e(d);g.log("[MODAL] initModal",b);if(f[0]){a=f.data("dv-modal");this.options={};g.log("[MODAL] initModal",{args:b,dataAttributes:a,defaults:c,options:this.options});this.options=e.extend(!0,{},c,b,a);this.id=b.id;this.elSelector=d;this.$el=f;this.options.content=f.html();if(this.options.content&&this.options.templatingArgs)this.options.content=this.renderTemplate(this.options.content,this.options.templatingArgs);
if(this.options.header.text&&this.options.templatingArgs)this.options.header.text=this.renderTemplate(this.options.header.text,this.options.templatingArgs);this.setUrl();this.createModal();this.triggerModal()}else g.log("[MODAL] initModal can not find element:"+d)},setUrl:function(){var b="";g.log("[MODAL] setUrl");this.options.url?(this.options.ajaxParameters&&(b=this.options.url.match(/\?/)?"&":"?",b+=e.param(this.options.ajaxParameters)),this.url=this.options.url+b):this.url=s},renderTemplate:function(b,
a){var c;g.log("[MODAL] renderTemplate",b,a);for(c in a)a.hasOwnProperty(c)&&(g.log("[MODAL] renderTemplate:"+c+" -> "+a[c]),b=b.replace("{"+c+"}",a[c]));return b},createModal:function(){var b=this;g.log("[MODAL] createModal");if(b.url||b.options.content)b.buttons=[],b.generateCancelButton(),b.generateSubmitButton(),b.generateCheckBox(),b.generateHeader(),b.generateFooter(),i.when("a-modal").execute(function(a){a.create(b.$el,{url:b.url,content:b.options.content,name:b.id,cache:!1,width:b.options.width,
header:b.header,footer:b.footer,closeButton:b.options.showCloseButton})})},triggerModal:function(){var b=this;g.log("[MODAL] triggerModal");d.trigger("dv:dp:player:close");i.when("a-modal").execute(function(a){a.get(b.id).show()})},hideModal:function(b){g.log("[MODAL] hideModal ",b);i.when("a-modal").execute(function(a){a.remove(b)})},generateHeader:function(){g.log("[MODAL] generateHeader");if(this.options.header)this.header=this.options.header.text},generateFooter:function(){var b="";g.log("[MODAL] generateFooter");
this.checkBox&&this.checkBox.html&&(b+=this.checkBox.html);this.cancelButton&&this.cancelButton.html&&(b+=this.cancelButton.html);this.submitButton&&this.submitButton.html&&(b+=this.submitButton.html);this.footer=b},getFooterUIElement:function(b){var a={},c=b.elemOptions,d=b.customSuffix,f=b.customEventDefault,e=b.template,h=b.isCheckBox;g.log("[MODAL] getFooterUIElement",b);if(c&&d&&f&&e){a.name=c.id||this.id+d;a.id="#"+a.name;a.text=c.text;a.eventArgs=c.eventArgs;a.customEvent=c.customEvent||f;
a.html="";if(a.text&&e)a.html=this.formatTemplate(e,a.name,a.text),h?this.addCheckBoxEventListener(a):this.addButtonEventListener(a);return a}},generateCancelButton:function(){g.log("[MODAL] generateCancelButton");this.cancelButton=this.getFooterUIElement({elemOptions:this.options.footer&&this.options.footer.cancelButton,customSuffix:"-cancel",customEventDefault:"dv:modal:close",template:this.cancelTemplate})},generateSubmitButton:function(){g.log("[MODAL] generateSubmitButton");this.submitButton=
this.getFooterUIElement({elemOptions:this.options.footer&&this.options.footer.submitButton,customSuffix:"-submit",customEventDefault:"dv:modal:click:submit:"+this.id,template:this.submitTemplate})},generateCheckBox:function(){g.log("[MODAL] generateCheckBox");this.checkBox=this.getFooterUIElement({elemOptions:this.options.footer&&this.options.footer.checkBox,customSuffix:"-check",customEventDefault:"dv:modal:checkbox:checked",template:this.checkBoxTemplate,isCheckBox:!0})},addButtonEventListener:function(b){g.log("[MODAL] addButtonEventListener",
b);e("body").delegate(b.id,"click",function(){d.trigger(b.customEvent,b.eventArgs)});this.buttons.push(b)},addCheckBoxEventListener:function(b){var a=this;g.log("[MODAL] addCheckBoxEventListener");e("body").delegate(b.id+" input[type='checkbox']","change",function(){b.eventArgs.checked=!!this.checked;b.eventArgs.url=a.options.customActionEndpoint;d.trigger(b.customEvent,b.eventArgs)})},removeEventListeners:function(){g.log("[MODAL] removeEventListeners");e.each(this.buttons,function(b,a){e("body").undelegate(a.id,
"click")})},formatTemplate:function(){var b=Array.prototype.shift.call(arguments),a=arguments;g.log("[MODAL] formatTemplate");return b?b.replace(/\{(\d+)\}/g,function(b,c){return typeof a[c]!=="undefined"?a[c]:b}):s}};f.init();return{create:function(b){var a=b.id;return{show:function(){f.initModal(b)},hide:function(){f.hideModal(a)},on:function(b,c){d.on("a:popover:"+b+":"+a,c)}}}}});i.when("A","logging","dv-ready-atf").register("js-modal",function(d,h){var e,g,c,f;function b(a){w.log("[js-modal] _createModal:",
a);var b=o("<div/>"),d={},h,m,k;if(!B)v.submitTemplate=o(e).html(),v.cancelTemplate=o(g).html(),v.linkTemplate=o(c).html(),v.checkBoxTemplate=o(f).html(),u=o.extend({},A),w.log("[js-modal] _init:",v,u),B=!0;if(!a.url&&!a.content)w.log("[js-modal] _createModal: no url or content"),h=a.selector||"#"+a.id,h=o(h),a.content=h.html(),h=h.data("dv-modal");u=o.extend(!0,{},a,h);w.log("[js-modal] _createModal:",{args:a,dataAttributes:h,options:u});if(u.url||u.content)a=u&&u.header&&u.header.text,h=l(u),b=
b.append(u.content).prop("outerHTML"),m=n(u),k=o("<div/>").attr({id:u.id}),d={url:m,content:b,name:u.id,cache:u.cache||!1,width:u.width||400,header:a,footer:h,closeButton:u.showCloseButton},w.log("[js-modal] modalArgs:",d),i.when("a-modal").execute(function(a){a.create(k,d).show()})}function a(a){d.trigger("dv:dp:expand:player");j(a);i.when("a-modal").execute(function(b){b.remove(a)})}function l(a){var b="",c=m({elemOptions:a&&a.footer&&a.footer.checkBox,customSuffix:"-check",customEventDefault:"dv:js-modal:checkbox:checked",
template:v.checkBoxTemplate,isCheckBox:!0}),d=m({id:a.id,elemOptions:a&&a.footer&&a.footer.cancelButton,customSuffix:"-cancel",customEventDefault:"dv:js-modal:close",template:v.cancelTemplate}),f=m({id:a.id,elemOptions:a&&a.footer&&a.footer.submitButton,customSuffix:"-submit",customEventDefault:"dv:js-modal:click:submit:"+a.id,template:v.submitTemplate}),g=a&&a.footer&&a.footer.submitButton,a=!g||!g.url?void 0:m({id:a.id,elemOptions:g,customSuffix:"-link",template:v.linkTemplate});c&&(b+=c.html);
d&&(b+=d.html);a?b+=a.html:f&&(b+=f.html);return b}function n(a){var b="",a=a||{},c=a.url||a.ajaxEndpoint;if(c)return a.ajaxParameters&&(b=c.match(/\?/)?"&":"?",b+=o.param(a.ajaxParameters)),c+b}function m(a){var b={},c=a.elemOptions,d=a.customSuffix,f=a.customEventDefault,g=a.template,e=a.isCheckBox;w.log("[js-modal] _getFooterUIElement:",a);if(c&&d&&g){b.name=c.id||a.id+d;b.id="#"+b.name;b.text=c.text;b.url=c.url;b.eventArgs=c.eventArgs;b.customEvent=c.customEvent||f;b.html="";if(b.text&&g)b.html=
p(g,b.name,b.text,b.url),e?q(b):k(b);w.log("[js-modal] _getFooterUIElement element:",b);return b}}function k(a){w.log("[dv-modal] addButtonEventListener button:",a);o("body").delegate(a.id,"click",function(){d.trigger(a.customEvent,a.eventArgs)});z.push(a)}function q(a){o("body").delegate(a.id+" input[type='checkbox']","change",function(){a.eventArgs.checked=!!this.checked;a.eventArgs.url=u.customActionEndpoint;d.trigger(a.customEvent,a.eventArgs)})}function j(){o.each(z,function(a,b){o("body").undelegate(b.id,
"click")})}function p(){var a=Array.prototype.shift.call(arguments),b=arguments;w.log("[js-modal] _formatTemplate:",a,b);return a?a.replace(/\{(\d+)\}/g,function(a,c){return typeof b[c]!=="undefined"?b[c]:a}):s}var o=d.$,A={isDebug:!1};e="#SubmitTemplate";g="#CancelTemplate";c="#LinkTemplate";f="#CheckBoxTemplate";var u={},v={},z=[],B=!1,w=h.create("js-modal");return{create:function(c){var f=c.id;return{show:function(){b(c)},hide:function(){a(f)},on:function(a,b){d.on("a:popover:"+a+":"+f,b)}}}}});
i.when("A","dv-easing").register("dv-breeze",function(d){var h=d.$,e={wrapperClass:"dv-breeze-wrapper",$wrapper:h("<div></div>").addClass("dv-breeze-wrapper"),elementsArray:[],content:"",transitionIn:"easeOutQuart",transitionOut:"easeInQuart",shouldMove:!0,moveOutDistancePercent:30,moveInDistancePercent:10,speedIn:400,speedOut:400,origHeight:0,toHeight:0};h.fn.extend({dv_breezeOut:function(d){var c=h.extend({},e,d);return this.each(function(){var d=h(this),b=0;c.origHeight=d.height();d.children().hasClass(c.wrapperClass)||
d.wrapInner(c.$wrapper);c.shouldMove&&(b=c.origHeight*c.moveOutDistancePercent/100);d.height(c.origHeight).css({overflow:"visible"}).children("."+c.wrapperClass).first().css({position:"relative"}).animate({opacity:0,top:b},c.speedOut,c.transitionOut,function(){try{var a=d.children("."+c.wrapperClass).first();c.save&&a?(c.elementsArray.push(a),a.detach()):a&&a.remove();c.callback&&typeof c.callback==="function"&&c.callback()}catch(b){throw d.stop(),b;}})})},dv_breezeIn:function(d){var c=h.extend({},
e,d);return this.each(function(){var d=h(this),b="",a=0;c.origHeight=d.height();c.shouldMove&&(a=c.origHeight*c.moveInDistancePercent/100);c.content?b=h(c.content).addClass(c.wrapperClass):c.elementsArray.length&&(b=c.elementsArray.pop());c.flush&&(d.height(c.origHeight),d.children("."+c.wrapperClass).remove());b.css({display:"block"});c.toHeight=d.css({height:"auto",overflow:"hidden"}).append(b).height();d.css({display:"block",overflow:"visible",height:c.origHeight+"px"});b.css({opacity:0,position:"relative",
top:a});d.animate({height:c.toHeight+"px"},c.speedIn,c.transitionIn,function(){try{d.css({overflow:"visible",height:"auto"}).children("."+c.wrapperClass).first().css({display:"block"}).animate({opacity:1,top:0},c.speedIn,c.transitionIn,function(){try{c.callback&&typeof c.callback==="function"&&c.callback()}catch(a){throw d.stop(),a;}})}catch(a){throw d.stop(),a;}})})}})});i.when("A","dv-easing","ready").register("dv-extender",function(d){var h=d.$,e=function(d){this.elem=d;this.$elem=h(d);return this};
if(h(".dv-extender")[0])e.prototype={init:function(){this.$content=this.$elem.find("p");this.lineHeight=parseInt(this.$content.css("lineHeight"),10);this.originalHeight=this.$elem.height();this.contentHeight=this.$content.height();this.options=this.$elem.data("extender")||{};this.seeMoreText=this.options.strings?h("<div/>").html(this.options.strings.seeMore).text():"";this.seeLessText=this.options.strings?h("<div/>").html(this.options.strings.seeLess).text():"";this.numOfLines=this.options.numOfLines||
1;this.maxNumOfLines=this.options.maxNumOfLines||1;this.useEllipsis=this.options.useEllipsis;this.resizeDelay=400;this.hasHiddenToggle=this.hasToggle=!1;this.isOpen=this.startsOpen=this.$elem.hasClass("dv-extender-open");this.classSeparator=" ";this.easing="easeOutCubic";this.speedQuick=200;this.speed=this.speedQuick+this.contentHeight;this.speed=this.speed>1E3?1E3:this.speed;this.ellipsisOnCss={whiteSpace:"nowrap",textOverflow:"ellipsis",overflow:"hidden"};this.ellipsisOffCss={whiteSpace:"normal"};
this.extend();this.attachEvents()},extend:function(){var d=this.ellipsisOffCss,c=this.$elem.height();this.setContentHeight();this.$elem.css({height:c,"max-height":"none"});if(this.contentHeight<=this.maxNumOfLines*this.lineHeight)this.expandToContentHeight(),this.hideLink();else{this.resetToggle();if(this.startsOpen)this.expandToContentHeight();else if(this.resetOriginalHeight(),this.useEllipsis)d=this.ellipsisOnCss;this.showLink()}this.$elem.find("p").css(d)},expandToContentHeight:function(){var d=
this;d.$elem.stop().animate({height:d.contentHeight},d.speed,d.easing,function(){d.$elem.css({height:"auto"})})},attachEvents:function(){var d=this,c=h("html").hasClass("a-lt-ie9"),f=h(j),b=f.width(),a=!0,e,n;f.resize(function(){c&&(n=f.width(),a=!1,b!==n&&(a=!0,b=n));clearTimeout(e);e=setTimeout(function(){a&&d.extend()},d.resizeDelay)})},attachClickEvent:function(){var d=this;d.$extenderAdjustLink&&d.$extenderAdjustLink.click(function(c){c.preventDefault();d.extenderToggle()})},showLink:function(){this.hasToggle?
this.$elem.siblings(".dv-extender-link").show():this.createLink()},createLink:function(){this.$extenderAdjustLink=h("<a></a>");this.$extenderAdjustLink.addClass("dv-extender-link"+this.classSeparator+this.getDefaultLinkClass()).text(this.getDefaultLinkText()).attr("href","#").css({display:"none"}).insertAfter(this.$elem).slideDown(this.speedQuick,this.easing);this.attachClickEvent();this.hasToggle=!0},getDefaultLinkClass:function(){return this.startsOpen?"dv-extender-see-less":"dv-extender-see-more"},
getDefaultLinkText:function(){return this.startsOpen?this.seeLessText:this.seeMoreText},hideLink:function(){if(this.hasToggle)this.hasHiddenToggle=!0,this.resetToggle(),this.$elem.siblings(".dv-extender-link").hide()},resetOriginalHeight:function(){this.$elem.stop().animate({height:this.originalHeight},this.speed,this.easing)},resetToggle:function(){this.changeLink(this.getDefaultLinkText(),this.getDefaultLinkClass())},setContentHeight:function(){this.$content.css(this.ellipsisOffCss);this.contentHeight=
this.$content.height()},extenderToggle:function(){var d=0,c="",f=this.ellipsisOffCss,b=this.seeLessText,a="dv-extender-see-less";this.setContentHeight();if(this.isOpen=this.$elem.hasClass("dv-extender-open")){if(d=this.originalHeight,c="",b=this.seeMoreText,a="dv-extender-see-more",this.useEllipsis)f=this.ellipsisOnCss}else d=this.contentHeight,c="dv-extender-open";this.changeLink(b,a);this.resizeContainer(d,c);this.$elem.find("p").css(f)},resizeContainer:function(d,c){var f=this;f.$elem.removeClass("dv-extender-open").addClass(c).stop().animate({height:d},
f.speed,f.easing,function(){if(!f.isOpen)f.isOpen=!0,f.$elem.css({height:"auto"})})},changeLink:function(d,c){this.$elem.siblings(".dv-extender-link").text(d).removeClass("dv-extender-see-more"+this.classSeparator+"dv-extender-see-less").addClass(c)}},h(".dv-extender").each(function(){(new e(this)).init()})});(function(d){d.when("A","dv-ready-atf").register("dv-toggle-box",function(d){var e=d.$,g=j.AMZNDetails||{},c={isDebug:!1,toggleBox:"div.dv-toggle-box",tbContainer:"div.dv-tb-container",tbContent:"div.dv-tb-content",
tbSwitch:".dv-tb-switch a",tbClosed:".dv-tb-closed",speed:400,openedClass:"js-opened"},f=function(){this.options=c;this.addEvents();this.init()};f.prototype={init:function(){this.log("ToggleBox",this.options);this.$element=e(this.options.toggleBox);this.$element[0]&&this.initState()},initState:function(){var b=this;b.$element.each(function(){var a=e(this);a.is(b.options.tbClosed)||a.addClass(b.options.openedClass)})},addEvents:function(){var b=this;e("body").delegate(b.options.tbSwitch,"click",function(a){var c=
e(this).closest(b.options.toggleBox);b.log("tbSwitch",c);b.toggleContent(c);a.preventDefault()});d.on("dv:ajax:chunk:replaced:dv-action-box",function(){b.init()})},removeEvents:function(){e("body").undelegate(this.options.tbSwitch,"click")},toggleContent:function(b){var a=b.find(this.options.tbSwitch),c=b.find(this.options.tbContainer);this.toggleSwitchLabel(a);b.hasClass(this.options.openedClass)?this.closeToggleBox(c):this.openToggleBox(c);b.toggleClass(this.options.openedClass)},openToggleBox:function(b){var a,
c,d;b.css({height:"",padding:"",display:"block"});a=b.height();c=b.css("padding-top");d=b.css("padding-bottom");b.css({height:0,padding:0,opacity:0});b.animate({opacity:1,height:a,"padding-top":c,"padding-bottom":d},this.options.speed,function(){e(this).css({height:"auto"})})},closeToggleBox:function(b){b.animate({opacity:0,height:0,paddingTop:0,paddingBottom:0},this.options.speed)},toggleSwitchLabel:function(b){var a,c;b.attr("data-alt-dialog")&&(a=b.text(),c=b.attr("data-alt-dialog"),b.attr("data-alt-dialog",
a).html("<span></span>"+c))},log:function(){var b=j.console&&j.console.log&&typeof j.console.log==="function";this.options&&this.options.isDebug&&b&&(b=Array.prototype.slice.call(arguments),j.console.log.apply(j.console,b))}};new f;g.ToggleBox=f;j.AMZNDetails=g})})(i);i.when("A","a-dropdown","dv-offset").execute("dv-dp-season-selector",function(d,h){var e=d.$,g=e(".js-season-dropdown .a-dropdown-prompt"),c=h.getSelect("dv-season-drop-down");if(c&&c.options&&c.options.$select&&g)c=c.options.$select,
c=c.find(":selected").data("a-html-content"),g.html(c);d.declarative("a-dropdown-button","click",function(c){var c=(c=c.$currentTarget)&&c.parents(".a-button-dropdown"),b=c.hasClass("js-season-dropdown"),a=c.hasClass("js-download-dropdown"),d=["dv-dropdown-wrapper"],g={},h=e(".dv-dropdown-wrapper");if(b||a)h.css({opacity:0}),g=c.dvOffset(),setTimeout(function(){var a=e(".dv-dropdown-option");a.hasClass("js-theme-dark")&&d.push("dv-theme-dark");a.parents(".a-dropdown").addClass(d.join(" ")).css({left:g.left,
top:g.top,opacity:1})},50)});d.on("a:dropdown:dv-season-drop-down:select",function(c){var b=c.value.split(":"),a=b[0],b=b[1],c=e(c.auiItemNode).html();g.html(c);document.location.href="/gp/product/"+a+"?ref_="+b})});i.when("A","ready").register("dv-form-validate",function(d){var h=d.$,d={init:function(){this.bindEvents()},validate:function(d){var g=0,c=d.find(".dv-form-submit"),d=d.find(".dv-required-field").filter("select");d.length&&(g+=this.validateSelectBoxes(d));g&&this.shake(c)},validateSelectBoxes:function(d){var g=
0,c=".dv-select-error".replace(".","");d.each(function(){var d=h(this),b=d.find("option:selected"),d=d.parent(".dv-ss-wrapper");b.is(".placeholder-selection")&&(g++,d.length&&d.addClass(c))});g&&h("body").delegate("change",d,function(){h(this).closest(".dv-select-error").removeClass(c)});return g},shake:function(d){d.css({position:"relative"}).animate({left:-1},0).delay(100).animate({left:1},0).delay(100).animate({left:-1},0).delay(100).animate({left:1},0).delay(100).animate({left:-1},0).delay(100).animate({left:0},
0)},bindEvents:function(){var d=this;h("body").delegate("form.dv-form-validate","submit",function(g){var c=h(this);d.validate(c);g.preventDefault()})}};h("form.dv-form-validate").length&&d.init()});i.when("A").register("dv-self-order-cancellation",function(d){d.on("dv:modal:click:submit:dv-self-cancel-modal",function(){i.when("a-dropdown").execute(function(h){var e=h.getSelect("dv-self-refund-drop-down").val().split(":",2),h=e[0],e=e[1],g=d.$("#selfOrderCancelLink"),c=g.data("orderCancelBaseUrl"),
g=g.data("pageAsin");if(h&&e&&c)document.location.href=c+"?orderId="+h+"&asin="+e+"&return_to=/gp/product/"+g})});d.declarative("self-cancel","click",function(h){h.data.numberOfEligibleOrders>1?d.trigger("dv:modal:show",{id:"dv-self-cancel-modal"}):j.location.href=h.$target.attr("href")})});i.when("A","dv-download-box","dv-dp-playback-init","dv-watchlist","dv-self-order-cancellation","dv-player-event-binding","dv-ready-atf").execute(function(d){var a;if(typeof j.setCSMReq==="function"){j.setCSMReq("cf");
var h=document.readyState==="complete";typeof j.ue==="object"&&typeof j.ue.tag==="function"&&j.ue.tag(h?"cf-after-load":"cf-before-load");h&&typeof j.uex==="function"&&((a=(d=d.state("dv-cf-config"))&&d.scope,d=a)?(typeof j.uet==="function"&&j.uet("cf",d),j.uex("ld",d)):j.uex("ld"))}typeof uex!=="undefined"&&j.uex("ld","dv-fire-cf-marker-js",{wb:1})});i.when("A").register("dv-image-loader",function(d){var h=d.$;return function(){var d=new Image;return{loadImageThenExecute:function(g,c){d.src=g;h(d).one("load",
c).each(function(){this.complete&&h(this).load()})}}}()});i.when("A","dv-image-loader","ready").register("dv-heroshot",function(d,h){var e=d.$;return function(g,c,f){if(!g)return!1;typeof f==="undefined"&&(f=!0);var b="-50px",a=["aivDetailsBackgroundPanel"];f&&a.push("js-hide-on-play");g.match(/UX940/g)&&(b="0px");e("<div/>").addClass(a.join(" ")).html("<div class='heroImage'></div><div class='aivDetailsGradient'><div></div></div>").prependTo(c).each(function(){h.loadImageThenExecute(g,function(){e(".heroImage").css({background:"url("+
g+") 0 0 no-repeat","background-position-x":"50%","background-position-y":b,height:"100%",display:"none"}).fadeIn(1E3);d.trigger("dv:dp:heroshot:ready")})})}});i.when("A","dv-heroshot","ready").execute(function(d,h){var e=d.$;(e=e(".share-widget").data("heroshot"))&&h(e,".dp-main")});i.when("A","dv-utilities","dv-ready-atf","dv-playback-buttons").register("dv-player-event-binding",function(d,h){function e(c){return(c=c.data("deeplink"))&&!g.isEmptyObject(c)}var g=d.$,c=d.state("dv-dp-fsk18-state")||
{};g("body").delegate("#continue-btn","click",function(f){var b=g(this),a=b.data("playback"),l=b.data("reftag"),n=a.asin;f.preventDefault();c.ageVerificationRequired?(f.stopPropagation(),i.when("dv-fsk18-modal").execute(function(a){a.showAgeVerificationModal(n)})):e(b)||(d.trigger("dv:dp:player:continue",a),l&&h.sendAnalytics(l))});g("body").delegate("#from-beginning-btn","click",function(f){var b=g(this),a=b.data("playback"),l=b.data("reftag"),n=a.asin;f.preventDefault();c.ageVerificationRequired?
(f.stopPropagation(),i.when("dv-fsk18-modal").execute(function(a){a.showAgeVerificationModal(n)})):e(b)||(d.trigger("dv:dp:player:startFromBeginning",a),l&&h.sendAnalytics(l))});g("#dv-dp-left-content").delegate(".dv-trailer","click",function(f){var b=g(this),a=b.data("playback"),l=b.data("reftag"),n=a.asin;b.data("skip-js")||(f.preventDefault(),c.ageVerificationRequired?(f.stopPropagation(),i.when("dv-fsk18-modal").execute(function(a){a.showAgeVerificationModal(n)})):!b.hasClass("disabled")&&!e(b)&&
(d.trigger("dv:dp:player:playTrailer",a),l&&h.sendAnalytics(l)))});i.when("dv-dp-player-initialized").execute(function(){d.delay(function(){var c;g("body").hasClass("auto-play-trailer-on")?d.trigger("dv:dp:player:playTrailer"):g("body").hasClass("auto-play-on")&&(c=g("#player_container_wrapper").data("play-from"),c===parseInt(c,10)?d.trigger("dv:dp:player:playfromsecond",{seconds:c}):d.trigger("dv:dp:player:continue"))},100)});d.declarative("a-modal",["click"],function(c){c&&c.$target&&(c.$target.hasClass("a-icon-share-email")||
c.$target.hasClass("shareTextAUI")||c.$target.hasClass("emailtext")||c.$target.hasClass("emailImg"))&&d.trigger("dv:dp:player:close")})});(function(d){d.when("ready").register("dv-browser-capabilities",function(){var d,e,g,c,f=function(){var a=null;if(typeof d!=="undefined")return d;try{a=!!new ActiveXObject("htmlfile")}catch(b){a=!1}return d=a},b=function(){return typeof e!=="undefined"?e:e=j.innerWidth===screen.width&&j.innerHeight>screen.height-50},a=function(){var a=-1,b,c;if(typeof g!=="undefined")return g;
if(navigator.appName==="Microsoft Internet Explorer")b=navigator.userAgent,c=/MSIE ([0-9]{1,}[.0-9]{0,})/,c.exec(b)!==null&&(a=parseFloat(RegExp.$1));else if(navigator.appName==="Netscape")b=navigator.userAgent,c=/Trident\/.*rv:([0-9]{1,}[.0-9]{0,})/,c.exec(b)!==null&&(a=parseFloat(RegExp.$1));return g=a};return{isActivexEnabled:f,isFullScreen:b,getIEVersion:a,isMetroBrowser:function(){return typeof c!=="undefined"?c:c=a()>9&&b()&&!f()}}})})(i);i.when("A").register("dv-util-reload-box",function(d){var h=
d.$,e;e=function(d){d?this.ajaxParams={ASIN:d}:this.reloadError()};e.prototype.prepareBoxForReload=function(){d.trigger("dv:pd:sidebox:pre:refresh");h("#dv-side-box-container").addClass("dv-side-box-reloading").wrapInner('<div class="dv-side-box-disable"></div>').prepend('<div id="dv-download-spinner" class="dv-dark-spinner"></div>')};e.prototype.animateNewContent=function(d){var c=this;this.$content=h(d);this.$content.prependTo(h("#dv-side-box-container"));d=this.$content.height();this.$content.hide();
h("#dv-download-spinner").remove();h("#dv-side-box-container").animate({height:d},500,function(){c.cleanUpPostRefresh()})};e.prototype.cleanUpPostRefresh=function(){h(".dv-side-box-disable").remove();this.$content.show().parent().removeClass("dv-side-box-reloading").css("height","auto")};e.prototype.reloadError=function(){d.trigger("dv:pd:sidebox:ajax:error",{id:"dv-modal-reload-box-failed"})};e.prototype.reload=function(){var g=this;g.prepareBoxForReload();d.ajax("/gp/video/widgets/buy-box/ajax/box.html",
{params:g.ajaxParams,success:function(c){g.animateNewContent(c)},error:function(){g.reloadError()}})};d.on("dv:pd:sidebox:trigger:refresh",function(d){i.when("dv-ready-atf").execute(function(){(new e(d)).reload()})});return e});i.when("A","dv-ready-page-state").register("dv-weblabs",function(d){var d=d.$,h=d("#dv-weblabs").html(),e=typeof h==="string"?d.parseJSON(h):{};return function(){return{isInWeblab:function(d,c){return e[d]===(c||"T1")?1:0}}}()});i.when("A").register("dv-cookies",function(){function d(d,
e,g){var c="";g&&(c=new Date,c.setTime(c.getTime()+g*864E5),c="; expires="+c.toGMTString());document.cookie=d+"="+e+c+"; path=/"}return{create:d,read:function(d){d+="=";for(var e=document.cookie.split(";"),g=0,c;g<e.length;g++){for(c=e[g];c.charAt(0)===" ";)c=c.substring(1,c.length);if(c.indexOf(d)===0)return c.substring(d.length,c.length)}return null},erase:function(h){d(h,"",-1)}}});i.when("logging").register("dv-client-side-metrics",function(d){var h=j.uet,e=j.ues,g=j.uex,c=j.ue,f=d.create("dv-client-side-metrics"),
b=function(a){f.log("[CSM] new with options",a);this.scope=a&&a.scope};b.prototype.record=function(a,b){f.log("[CSM] uet "+this.scope+" "+a,b);typeof h==="function"&&h(a,this.scope,b)};b.prototype.set=function(a,b){f.log("[CSM] ues "+this.scope+" "+a,b);typeof e==="function"&&e(a,this.scope,b)};b.prototype.publish=function(a,b){typeof g==="function"&&g(a,this.scope,b)};b.prototype.counter=function(a,b,d){f.log("[CSM] ue.count "+a+" "+b);d=d||{scope:this.scope};c&&typeof c.count==="function"&&c.count(a,
(c.count(a,s,d)||0)+(b||1),d)};b.prototype.timeOfClick=function(a){this.record("tc",a)};b.prototype.experiment=function(a){this.record("x",a)};b.prototype.calculationEnd=function(a){this.record("pc",a)};b.prototype.clickToNavStart=function(a){this.record("ns",a)};b.prototype.clickToNavEnd=function(a){this.record("ne",a)};b.prototype.clickToBodyBegin=function(a){this.record("bb",a)};b.prototype.clickToATF=function(a){this.record("af",a)};b.prototype.clickToCF=function(a){this.record("cf",a)};b.prototype.clickToBodyEnd=
function(a){this.record("be",a)};b.prototype.requestId=function(a){this.set("id",a)};b.prototype.startTime=function(){this.set("t0",new Date)};b.prototype.baseOnClientTime=function(){this.set("ctb","1")};b.prototype.clickToPageLoaded=function(a){this.publish("ld",a)};b.prototype.ajaxStart=function(a){this.timeOfClick(a)};b.prototype.ajaxSuccess=function(a){var b=a.requestId,a=a.xhr;!b&&a&&typeof a.getResponseHeader==="function"&&(b=a.getResponseHeader("x-amz-id-1"));this.requestId(b);this.startTime();
this.baseOnClientTime()};b.prototype.ajaxDone=function(a){this.clickToBodyEnd(a);this.clickToPageLoaded(a)};return{create:function(a){return new b(a)}}});i.when("A","dv-weblabs","dv-ajax-reload","ready").register("dv-episode-playback",function(d,h){var e=d.$,g=["dv-dp-main-content","dv-main-bottom-section","dv-episode-list"],c=d.state("dv-device-state")||{},f=d.state("dv-dp-state")||{};if(!(c&&c.deepLinkingEnabled||!h.isInWeblab("inEpisodeListPlaybackWeblab","T2")&&!h.isInWeblab("inEpisodeListPlaybackWeblab",
"T4")))return c={init:function(){this.transitionIsOn=!1;this.bindEvents()},bindEvents:function(){var b=this;e(".dv-ep-watch").live("click",function(a){a.preventDefault();var c=e(this).data(),d=c.asin;!b.transitionIsOn&&d&&(f.ageVerificationRequired?(a.stopPropagation(),i.when("dv-fsk18-modal").execute(function(a){a.showAgeVerificationModal(d)})):b.updatePlayer(c))})},updatePlayer:function(b){var a=this,c=e(j).scrollTop(),f=0;a.transitionIsOn=!0;c>0&&(f=c>300?300:c);e("html, body").animate({scrollTop:"0px"},
f,function(){if(a.transitionIsOn)a.transitionIsOn=!1,d.delay(function(){a.updatePage(b)},500),d.trigger("dv:dp:player:continue")})},updatePage:function(b){d.trigger("dv:dp:ajax:refresh:sections",{asin:b.asin,widgets:g,title:b.title})}},c.init(),c});i.when("A","js-modal","dv-ready-page-state").register("dv-watchlist",function(d,h){var e=d.$,g,c={asin:null,token:null,custIsRecognized:!1,isOnWatchlist:!1,isDebug:!1,refTagPrefix:"dp",refTag:null,addRemoveUrl:"/gp/video/watchlist/ajax/addRemove.html",
clickedButton:null,dataType:"json"},f=[],b=j.ue,a;a=function(a,b){if(!(e.inArray(a.element,f)>-1))f.push(a.element),this.options=e.extend({},c,a),this._defaults=c,this.locale=b,this.init()};a.prototype={init:function(){var a=this;this.log("AddToWatchlist added for",this.options);this.status="";this.isOnWatchlist=this.options.isOnWatchlist;e("body").delegate(this.options.element,"click",function(b){a.clickedButton=e(this);a.log({clickedButton:a.clickedButton});a.clickHandler(b)});d.on("dv:js-modal:click:submit:dv-watchlist-error-modal",
function(){a.errorModal&&a.errorModal.hide()})},clickHandler:function(a){a.preventDefault();this.log("clickHandler triggerd",a);if(this.status!=="processing")this.options.custIsRecognized?(this.status="processing",this.updateButton(),this.addRemoveCall()):j.location.href="/gp/video/watchlist"},updateButton:function(){var a=this.getButtonText();this.log("updateButton triggerd",a,{buttonClicked:this.clickedButton});this.clickedButton.toggleClass("dv-processing").find(".dv-button-inner").val(a)},getButtonText:function(){var a=
this.status==="processing";this.log("getButtonText triggerd"," isProcessing:"+a," isOnWatchlist:"+this.isOnWatchlist,"locale",this.locale);a=a&&this.isOnWatchlist?this.options.prodType==="movie"?"removeMovieProcessing":"removeTvProcessing":a?this.options.prodType==="movie"?"addMovieProcessing":"addTvProcessing":this.isOnWatchlist?this.options.prodType==="movie"?"removeMovie":"removeTv":this.options.prodType==="movie"?"addMovie":"addTv";this.log("key:"+a,"buttonText:"+this.locale[a]);return this.locale[a]},
getRefTag:function(){if(this.options.prodType)return this.isOnWatchlist?this.options.prodType==="movie"?this.options.refTagPrefix.replace(/_\$/,"")+"_wtls_rmv_mov":this.options.refTagPrefix.replace(/_\$/,"")+"_wtls_rmv_tv":this.options.prodType==="movie"?this.options.refTagPrefix.replace(/_\$/,"")+"_wtls_add_mov":this.options.refTagPrefix.replace(/_\$/,"")+"_wtls_add_tv"},getPageData:function(){var a={};g=g||d.state("dv-dp-context");typeof g!=="undefined"&&g.pageType&&(a=g);return a},addRemoveCall:function(){var a=
this,b=this.isOnWatchlist?"remove":"add",c=this.getPageData();e.ajax({url:this.options.addRemoveUrl,data:{dataType:this.options.dataType,ASIN:this.options.asin,token:this.options.token,ref_:this.getRefTag(),action:b,pageType:c.pageType,subPageType:c.subPageType,store:c.store,request:c.requestId},dataType:this.options.dataType,jsonpCallback:this.options.dataType==="jsonp"?"callback":"",success:function(b){a.status="done";a.log("AsinStatus:"+b.AsinStatus,"status:"+a.status);a.isOnWatchlist=parseInt(b.AsinStatus,
10)===1?!0:!1;a.updateButton()},error:function(b){a.status="done";a.isOnWatchlist=b.AsinStatus;a.updateButton();a.popError();a.logMessage("WATCHLIST_TASK_FAILED")},timeout:1E4})},log:function(){if(this.options.isDebug&&j.console){var a=Array.prototype.slice.call(arguments);j.console.log.call?j.console.log.call(j.console,a):j.console.log(a)}},fail:function(){if(this.options.isDebug&&j.console){var a=Array.prototype.slice.call(arguments);j.console.error.call?j.console.error.call(j.console,a):j.console.error(a)}},
createPopup:function(){var a=this;new amznAIV.Popover(a.locale.getTheAppMsg,function(){document.location=a.options.appUrl},function(){return!1})},popError:function(){this.errorModal=h.create({id:"dv-watchlist-error-modal"});this.errorModal.show()},logMessage:function(a){typeof b!=="undefined"&&typeof b.count!=="undefined"&&(a="DVWeb::ErrorMessage::"+a,b.count(a,(b.count(a)||0)+1))}};return a});i.when("A","dv-weblabs","dv-web-player-config").register("dv-dp-pharos-scene-selector",function(d,h,e){var g=
d.$;return function(c,d){function b(){var b;a||i.when("dv-carousel").execute(function(d){var f=c.find(".dv-wdgt-carousel");f.length>0&&(a=new d(f));a&&c.find("li.pharos-scene.isSelected").length>0&&(b=c.find("li").index(g(".pharos-scene.isSelected")),a.scrollToItem(b))})}var a;return{show:function(){c.is(":visible")||c.slideDown("slow");b()},hide:function(){c.is(":visible")&&c.animate({height:"toggle",opacity:"toggle"},{duration:"slow"})},selectPharosScene:function(a){var b=a.data()||{},h=b.asin,
i=b.starttime,q=(c.find(".isSelected").data()||{}).asin,j=!1,p=d!==null&&typeof d.type==="function"?d.type():"cascadePlayer";d!==null&&i!==null&&h&&(h===q?(b=g.extend(e.getAutoplayConfig(),{asin:h,position:i,clickstreamRefMarker:b.ref}),d.play(b),j=!0):h===q&&p==="silverlight"?(d.seek(i),j=!0):d.stop(),c.find(".isSelected").removeClass("isSelected"),a.addClass("isSelected"));return j}}}});i.when("A","dv-dp-pharos-scene-selector","dv-utilities","dv-player-integration-layer","dv-weblabs").register("dv-dp-pharos-scene-selector-view",
function(d,h,e,g){function c(a,b){b.find(".pharos-scene-selector .carousel .shelf li").each(function(){var b=f(this),c=b.children("a");b.data();c.click(function(d){if(a.selectPharosScene(b)&&(d.preventDefault(),d=c.prop("href")))(d=e.getReftagFromURL(d))&&e.sendAnalytics(d)})})}var f=d.$,b=!1,a=f(".pharos-scene-selector-container");b||(a.each(function(){var a=f(this),b=h(a,g);d.on("dv:dp:player:continue",b.show);d.on("dv:player:closed",b.hide);c(b,a)}),b=!0)});i.when("A","dv-ready-atf").register("dv-alerts",
function(d){function h(d){if(typeof d.format==="undefined")d.format=c;var b=[g,d.format,d.type].join("-"),b=e("#"+b).html();d.theme==="light"&&b&&(b=b.replace(/dv-alerts-dark/g,"dv-alerts-light"));b=e(b);d=d.content;return b.length===0||!d?void 0:b.find(".a-alert-content").html(d).end()[0]}var e=d.$,g="dv-alert-template",c="inline";return{getAlert:h,info:function(c,b,a){return h({content:c,format:b,theme:a,type:"info"})},warning:function(c,b,a){return h({content:c,format:b,theme:a,type:"warning"})},
error:function(c,b,a){return h({content:c,format:b,theme:a,type:"error"})},success:function(c,b,a){return h({content:c,format:b,theme:a,type:"success"})}}});i.when("A").register("dv-util-event",function(){var d;d=function(h,e){var g;if(!(h instanceof Object)||!(e instanceof Object))return!1;if(h===e)return!0;for(g in h)if(e.hasOwnProperty(g)){if(!e.hasOwnProperty(g))return!1;if(h[g]!==e[g]){if(typeof h[g]!=="object")return!1;if(!d(h[g],e[g]))return!1}}else return!1;for(g in e)if(!h.hasOwnProperty(g)&&
e.hasOwnProperty(g))return!1;return!0};return{bestowEvents:function(d){var e={};d.fire=function(d,c){var f,b,a,h;f=typeof d==="string"?d:d.type;if(e.hasOwnProperty(f)){f=e[f];for(h=0;h<f.length;h+=1)a=f[h],b=a.method,typeof b==="string"&&(b=this[b]),c?c=[c]:a.parameters&&(c=[a.parameters]),b.apply(this,c||[])}return this};d.on=function(d,c,f){c={method:c,parameters:f};e.hasOwnProperty(d)?e[d].push(c):e[d]=[c];return this};return d},create:function(d){var e=function(){};e.prototype=d;return new e},
isSameObject:d}});i.when("A","dv-pin-view","dv-util-event","dv-async").register("dv-pin-controller",function(d,h,e,g){var c=d.$,f=g.create("dv-pin-controller",i),b={strings:{CHECKING_PIN:"Checking Pin...",PIN_INVALID:"The Pin you have entered is invalid, please try again.",AUTHENTICATION_SUCCESS:"Authentication successful.",AUTHENTICATION_FAILURE:"This pin is not correct, please try again",TOKEN_FAILURE:"Your session has expired, please refresh the page and try again.",BAD_REQUEST:"We had a problem validating your pin, please refresh the page and try again"},
urls:{pinCheckUrl:"/gp/video/widgets/pin-authentication/ajax/pin-required-check.html",pinAuthUrl:"/gp/video/widgets/pin-authentication/ajax/pin-authentication.html"},action:"PURCHASE",validationPeriod:1E3,successMsgDuration:200,isTestRun:!1,numPins:5,view:{pinConfig:{numPins:5},events:{submit:"submitPin",show:"show",hide:"hide",cancel:"cancel",close:"close"}}};return{create:function(a,g){var i={},m,k={},q={},j,p,o=function(a,b){i.fire(a,b)},A=function(){var a=m.getUserPin();RegExp("^\\d{"+k.numPins+
"}$").test(a)?(m.createMessage("info",k.strings.CHECKING_PIN),r(a)):(m.createMessage("error",k.strings.PIN_INVALID),m.resetPin())},u=function(){var a=j;w(a)?D(a):(delete q[a],o("pinAuthFailure",{asins:a}));delete j},v=function(a,b,c){a&&(b||(b="UNAUTHORIZED"),q[a]=z(b,c))},z=function(a,b){var c=(new Date).getTime(),d=c+k.validationPeriod;return{getStatus:function(){return a},getTimestamp:function(){return c},isExpired:function(){return d<(new Date).getTime()},getToken:function(){return b}}},B=function(a){if(a)return q[a]||
x(a),q[a]},w=function(a){if(!a)return!1;s(a);return B(a).getStatus()==="AUTHORIZED"&&s(a)?!0:!1},D=function(a){var b=B(a);switch(b.getStatus()){case "ERROR":d.trigger("dv:purchase:generic:error","DV_PIN_ERROR");v(a,"UNAUTHORIZED");break;case "AUTHORIZED":s(a)?o("success",{asins:a,token:b.getToken()}):(v(a,"UNAUTHORIZED"),D(a));break;case "UNAUTHORIZED":m.trigger(k.view.events.show);j=a;break;case "PENDING":p=!0}},s=function(a){a=B(a);return a.getStatus()!=="AUTHORIZED"?!1:a.isExpired()?!1:!0},F=function(a){a&&
typeof a==="function"&&a()},H=function(a){f.ajax(a.url,{params:a.data,success:function(b){a.success(b);F(a.complete)}},{maxRetrys:3,customError:function(){o("error");F(a.error);F(a.complete)}})},r=function(a){H({url:k.urls.pinAuthUrl,data:{csrfToken:k.csrfToken,pin:a},success:C,complete:function(){o("pinAuthenticationComplete")},error:function(){m.createMessage("error",k.strings.AUTHENTICATION_FAILURE)}})},C=function(a){var b=j,c;if(a.success)m.createMessage("success",k.strings.AUTHENTICATION_SUCCESS),
v(b,"AUTHORIZED",a.token),m.trigger(k.view.events.hide,{delay:k.successMsgDuration});else{switch(a.error){case "INVALID_CSRF_TOKEN":c=k.strings.TOKEN_FAILURE;break;case "BAD_REQUEST":c=k.strings.BAD_REQUEST;break;case "WRONG_PIN":case "INCORRECT_PIN_FORMAT":c=k.strings.AUTHENTICATION_FAILURE}m.createMessage("error",c);m.resetPin()}},x=function(a){v(a,"PENDING");H({url:k.urls.pinCheckUrl,data:{ASINS:a,csrfToken:k.csrfToken,action:k.action},asin:a,complete:function(){p&&(p=!1,D(a));o("pinRequiredCheckComplete")},
success:function(b){var c="UNAUTHORIZED";if(b&&typeof b==="object")if(b.error&&b.error==="BAD_REQUEST"||b.error==="TOKEN_INVALID")c="ERROR";else if(b.pinRequired){if(c="UNAUTHORIZED",b=b.numPinsRequired)k.numPins=b,m.setNumViewPins(b)}else c="AUTHORIZED";v(a,c)}})};(function(a,f){c.extend(!0,k,b,a);m=k.isTestRun&&f?f:h.create(k.view);e.bestowEvents(i);m.on(k.view.events.submit,A);m.on(k.view.events.close,u);d.on("dv:purchase:cancel",function(a){delete q[a.asins];delete j})})(a,g);return{on:function(a,
b){i.on([a],b)},trigger:o,isAuthorized:w,performPinRequiredCheck:x,getAsinStatus:B,handleAsinAuthorization:D}}}});i.when("A","dv-util-event","dv-modal","dv-alerts").register("dv-pin-view",function(d,h,e,g){var c=d.$,f={focusFieldsOnKeyUp:!0,id:"dv-pin-pop",isIosDevice:!1,selectors:{modalSelector:"#dv-pin-pop",pinWrap:"#pin-wrap",continueButton:"#dv-pin-pop-submit",cancelButton:"#dv-pin-pop-cancel",statusMsg:".dv-pin-pop-status-msg"},selectorFragments:{submitSuffix:"-submit"},hasCustomConfig:!1,pinConfig:{numPins:5,
numPinInputs:s,pinInputParams:{pattern:"[0-9]*",type:"password",size:"1",maxlength:"1","class":"pinNum"}},events:{submit:"submitPin",show:"show",hide:"hide",close:"close"}};return{create:function(b){var a={},l,i,m={},k,q,t,p,o,A=function(a,b){m.fire(a,b)},u=function(){var b=document.createElement("input"),c=a.pinConfig.pinInputParams,d;for(d in c)c.hasOwnProperty(d)&&b.setAttribute(d,c[d]);return b},v=function(a){var b=c(this);a.which===8&&(b.val().length>0||b.prev("input").focus().val(""))},z=function(b){var d=
c(this),f=d.not().is(":last-child"),g=d.val().length>0,b=b.which===13,e=D().length===a.pinConfig.numPins;e?l&&(t.removeClass("a-button-disabled").find("input").removeAttr("disabled"),l=!1):B();b&&e?w():g&&!f&&!e&&d.next().focus();i&&F()},B=function(){l||(t.addClass("a-button-disabled").find("input").attr("disabled","disabled"),l=!0)},w=function(){A(a.events.submit)},D=function(){var a=[];q.each(function(b,c){c.value.length&&(c.value.length>1?a=c.value.split(""):a.push(c.value))});return a},s=function(){q.val("");
d.delay(function(){q.first().focus()},10);B()},F=function(){i=!1;k&&k.find(a.selectors.statusMsg).html("")};c.extend(!0,a,f,b);h.bestowEvents(m);p=e.create({selector:a.selectors.modalSelector,id:a.id});m.on(a.events.show,function(){j.modal=p;p.show()});m.on(a.events.hide,function(a){a.delay?d.delay(p.hide,a.delay):p.hide()});p.on("afterShow",function(b){o=b.popover;k=o.$popover;for(var d=k.find(a.selectors.pinWrap),f=a.pinConfig.numPinInputs||a.pinConfig.numPins,b=1;b<=f;b+=1)d.append(u());q=d.find("input");
t=c("#"+a.id+a.selectorFragments.submitSuffix);t.find("input").click(w);a.focusFieldsOnKeyUp&&(q.keyup(z),q.keydown(v));s()});p.on("afterHide",function(){A(a.events.close);F();q.remove();k.find("input").unbind();l=!1;delete k});return{getUserPin:function(){return D().join("")},on:function(a,b){m.on([a],b)},trigger:A,createMessage:function(b,c){var d;g[b]&&typeof(g[b]==="function")&&(d=g[b](c),F(),k.find(a.selectors.statusMsg).html(d),i=!0)},resetPin:s,setNumViewPins:function(b){if(b)a.pinConfig.numPins=
b,a.hasCustomConfig?(a.pinConfig.pinInputParams.size=b,a.pinConfig.pinInputParams.maxlength=b):a.pinConfig.numPinInputs=b}}}}});i.when("A","ready").register("dv-deep-linking",function(d){var h=d.$,e=d.state("dv-device-state"),g,c,f;if(e&&(!e||e.deepLinkingEnabled))g={init:function(b){this.reftag=b.reftag;this.deepLinkingURL=b.link;this.urlToReload=document.location.protocol+"//"+document.location.host+document.location.pathname;this.urlToReload=this.urlToReload.replace(/\/ref=.+_(watch_now|wn)/,"");
this.appInstallURL=e.appURL},fireAnalytics:function(b){h.ajax({url:"/gp/video/usdvm/ajax/analytics.html/ref="+this.reftag,data:{subPageType:"WatchButton"},complete:b})},create:function(){return Object.create(this)}},c=g.create(),c.WAIT_FOR_APP=1E3,c.WAIT_FOR_APP_TRESHOLD=100,c.bindGuardEvents=function(){var b=this;b.clickGuard=d.on("dv:dp:dl:window:click",function(){b.runGuard()});b.pageshowGuard=d.on("dv:dp:dl:window:pageshow",function(){b.unRegisterGuardEvents();j.stop();document.location=b.urlToReload})},
c.runGuard=function(){var b=this;d.delay(function(){(new Date).getTime()-b.deeplinkingAttemptTime>b.WAIT_FOR_APP+b.WAIT_FOR_APP_TRESHOLD?b.unRegisterGuardEvents():(d.trigger("dv:modal:show",{id:"dv-modal-download-ipad-app"}),d.on("dv:modal:click:submit:dv-modal-download-ipad-app",function(){d.trigger("dv:modal:close");b.unRegisterGuardEvents();document.location=b.appInstallURL}),d.on("dv:modal:close",function(){b.unRegisterGuardEvents()}))},b.WAIT_FOR_APP)},c.unRegisterGuardEvents=function(){d.off(this.clickGuard);
d.off(this.pageshowGuard)},c.run=function(){var b=this;b.deeplinkingAttemptTime=(new Date).getTime();b.bindGuardEvents();b.runGuard();b.fireAnalytics(function(){if(e.deviceVersion>=9)j.location=b.deepLinkingURL;else{var a=document.createElement("iframe");a.style.display="none";a.name=a.id="iosDeepLinkingIframe";document.body.appendChild(a);j.frames.iosDeepLinkingIframe.location=b.deepLinkingURL;d.delay(function(){a&&a.parentNode&&a.parentNode.removeChild(a)},50)}})},f=g.create(),f.bindGuardEvents=
function(){var b=this;if(!b.reftag.match(/trailer/)){var a,c;typeof document.hidden!=="undefined"?(a="hidden",c="visibilitychange"):typeof document.mozHidden!=="undefined"?(a="mozHidden",c="mozvisibilitychange"):typeof document.msHidden!=="undefined"?(a="msHidden",c="msvisibilitychange"):typeof document.webkitHidden!=="undefined"&&(a="webkitHidden",c="webkitvisibilitychange");h(document).bind(c,function(){if(!document[a])document.location=b.urlToReload})}},f.run=function(){var b=this;b.bindGuardEvents();
b.fireAnalytics(function(){document.location=b.deepLinkingURL})},function(){var b=function(a){var b=(e.deviceType==="IOS"?c:f).create();b.init(a);b.run()};e.deviceType!=="silk"&&(h(j).click(function(){d.trigger("dv:dp:dl:window:click")}),h(j).bind("pageshow",function(){d.trigger("dv:dp:dl:window:pageshow")}));h(".deep-linkable").live("click",function(a){a.preventDefault();a=h(this).data("deeplink");b(a)});e.autoPlay&&b(e.autoPlay)}()});i.when("A","dv-dp-autoplay","dv-dp-playback-init").execute(function(d,
h){var e=d.$,g=function(c){c!==null&&c.asin&&i.when("deeplinking").execute(function(b){b.prepare(c)})},c=function(){var c=e(".dv-play-btn a"),b=e(".dv-trailer-button a");g((c.length?c:b).data())};(function(){h.isAutoPlayOn()||c();d.on("dv:ajax:chunk:replaced:dv-action-box",function(){c()})})()});i.when("jQuery","ready").execute(function(d){d(".dv-load-url-js-win").click(function(h){h.preventDefault();var h=parseInt(d(this).data("jsWinHeight"),10)||660,e=parseInt(d(this).data("jsWinWidth"),10)||680,
g=j.screen.width/2-e/2,c=j.screen.height/2-h/2-70;g<0&&(g=0);c<0&&(c=0);j.open(this.href,"_blank","location=yes,left="+g+",top="+c+",width="+e+",height="+h)})})})})(function(){var i=window.AmazonUIPageJS||window.P,j=i._namespace||i.attributeErrors;return j?j("DigitalVideoProductDetailsStaticAssets"):i}(),window);